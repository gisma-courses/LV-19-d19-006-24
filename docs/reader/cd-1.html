<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Advanced GIS and Remote Sensing - Change Detection - Sentinel</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: green;
      }

      .quarto-title-block .quarto-title-banner {
        color: green;
background-image: url(images/hinterland-sp.jpg);
background-size: cover;
      }
</style>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="../site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="../site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="../site_libs/corine_harz - 1_df1783-1/data_stars_corine_harz1b79204.txt"></script>
<script src="../site_libs/joda-0.0.1/joda.js"></script>
<script src="../site_libs/joda-0.0.1/addImageQuery-bindings.js"></script>
<script src="../site_libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="../site_libs/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="../site_libs/HomeButton-0.0.1/home-button.js"></script>
<script src="../site_libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<link href="../site_libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">
<link href="../site_libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">
<script src="../site_libs/harz_forest_mask_1cb609-1/data_stars_harz_forest_maska6875c.txt"></script>


<link rel="stylesheet" href="../css/styles.css">
<meta property="og:title" content="Advanced GIS and Remote Sensing - Change Detection - Sentinel">
<meta property="og:description" content="Clusteranalysis, Maximum-Likelihood and ML">
<meta property="og:site_name" content="Advanced GIS and Remote Sensing">
<meta name="twitter:title" content="Advanced GIS and Remote Sensing - Change Detection - Sentinel">
<meta name="twitter:description" content="Clusteranalysis, Maximum-Likelihood and ML">
<meta name="twitter:creator" content="@gisma">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/logooil.jpg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Advanced GIS and Remote Sensing</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../base/faq.html"> <i class="bi bi-question-square-fill" role="img">
</i> 
<span class="menu-text">FAQ</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://ilias3.uni-marburg.de/ilias.php?baseClass=ilrepositorygui&amp;cmdNode=zj:ne&amp;cmdClass=ilObjCourseGUI&amp;cmd=edit&amp;ref_id=4123762"> <i class="bi bi-chat-left-text-fill" role="img">
</i> 
<span class="menu-text">Ilias</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Change Detection - Sentinel</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">Change Detection - Sentinel</h1>
            <p class="subtitle lead">Clusteranalysis, Maximum-Likelihood and ML</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">GIS Basics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://gisma--courses-github-io.translate.goog/geoinfo-basis-qgis//unit01/unit01-01_reader_geo_raum.html?_x_tr_sl=de&amp;_x_tr_tl=en&amp;_x_tr_hl=de&amp;_x_tr_pto=wapp" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Space needs a scope</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://gisma--courses-github-io.translate.goog/geoinfo-basis-qgis//unit02/unit02-01_reader_gi_raum.html?_x_tr_sl=de&amp;_x_tr_tl=en&amp;_x_tr_hl=de&amp;_x_tr_pto=wapp" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial Representation in GI</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">R-Spatial Basics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://gisma-courses.github.io/LV-19-d19-006/morea/geocomputation-with-r/reading-screencast-spatial-r-gis-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Some Pros &amp; Cons for R-Spatial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://thinking-spatial.org/courses/geoinformationen_kommunizieren/kurs1/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">First steps in geospatial R (German Ressource)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://r.geocompx.org/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geocomputation with R</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/slides_session1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial Pattern Description</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/slides_session2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Landscape Patterns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/slides_session3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Landscape Patterns Reloaded</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/slides_session4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pattern-based spatial analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/slides_session5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continous data spatial analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Reader</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reader/cd-1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Classification Workflow</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Worksheets</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/ws-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prerequisies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/ws-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Worksheet 1: Warm Up Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/ws-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Worksheet 2: Landscape metrics part 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/ws-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Worksheet 3: Landscape metrics part 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/ws-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Worksheet 4: Pattern-based spatial analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/ws-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Worksheet 5: Regionalisation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#goals" id="toc-goals" class="nav-link" data-scroll-target="#goals">Goals</a></li>
  <li><a href="#information-from-satellite-imagery" id="toc-information-from-satellite-imagery" class="nav-link" data-scroll-target="#information-from-satellite-imagery">Information from satellite imagery</a></li>
  <li><a href="#theoretical-principles" id="toc-theoretical-principles" class="nav-link" data-scroll-target="#theoretical-principles">Theoretical principles</a>
  <ul class="collapse">
  <li><a href="#unsupervised-classification---k-means-clustering" id="toc-unsupervised-classification---k-means-clustering" class="nav-link" data-scroll-target="#unsupervised-classification---k-means-clustering">Unsupervised Classification - k-means clustering</a></li>
  <li><a href="#supervised-classification" id="toc-supervised-classification" class="nav-link" data-scroll-target="#supervised-classification">Supervised classification</a></li>
  </ul></li>
  <li><a href="#change-detection-case-study-harz-mountains" id="toc-change-detection-case-study-harz-mountains" class="nav-link" data-scroll-target="#change-detection-case-study-harz-mountains">Change detection case study: Harz Mountains</a>
  <ul class="collapse">
  <li><a href="#setting-up-the-work-environment" id="toc-setting-up-the-work-environment" class="nav-link" data-scroll-target="#setting-up-the-work-environment">Setting up the work environment</a></li>
  <li><a href="#defining-the-area-of-interest" id="toc-defining-the-area-of-interest" class="nav-link" data-scroll-target="#defining-the-area-of-interest">Defining the Area of Interest</a></li>
  </ul></li>
  <li><a href="#step-1-retrieving-sentinel-data" id="toc-step-1-retrieving-sentinel-data" class="nav-link" data-scroll-target="#step-1-retrieving-sentinel-data">Step 1: Retrieving Sentinel data</a>
  <ul class="collapse">
  <li><a href="#aternative-1-using-gdalcubes" id="toc-aternative-1-using-gdalcubes" class="nav-link" data-scroll-target="#aternative-1-using-gdalcubes">Aternative 1: Using <code>gdalcubes</code></a></li>
  <li><a href="#alternative-2-copernicus-data-space-ecosystem-api-wrapper-cdse" id="toc-alternative-2-copernicus-data-space-ecosystem-api-wrapper-cdse" class="nav-link" data-scroll-target="#alternative-2-copernicus-data-space-ecosystem-api-wrapper-cdse">Alternative 2: Copernicus Data Space Ecosystem API Wrapper CDSE</a></li>
  </ul></li>
  <li><a href="#step2-overview-unsupervised-classification" id="toc-step2-overview-unsupervised-classification" class="nav-link" data-scroll-target="#step2-overview-unsupervised-classification">Step2: Overview – Unsupervised classification</a>
  <ul class="collapse">
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering">k-means clustering</a></li>
  <li><a href="#bfast-spatial-identification-of-magnitudes-and-time-periods-of-kndvi-changes" id="toc-bfast-spatial-identification-of-magnitudes-and-time-periods-of-kndvi-changes" class="nav-link" data-scroll-target="#bfast-spatial-identification-of-magnitudes-and-time-periods-of-kndvi-changes">bfast: Spatial identification of magnitudes and time periods of kNDVI changes</a></li>
  </ul></li>
  <li><a href="#step-3---generating-training-data" id="toc-step-3---generating-training-data" class="nav-link" data-scroll-target="#step-3---generating-training-data">Step 3 - Generating training data</a></li>
  <li><a href="#step-4---supervised-classification" id="toc-step-4---supervised-classification" class="nav-link" data-scroll-target="#step-4---supervised-classification">Step 4 - supervised classification</a>
  <ul class="collapse">
  <li><a href="#maximum-likelihood-classification-1" id="toc-maximum-likelihood-classification-1" class="nav-link" data-scroll-target="#maximum-likelihood-classification-1">Maximum Likelihood Classification</a></li>
  <li><a href="#random-forest-1" id="toc-random-forest-1" class="nav-link" data-scroll-target="#random-forest-1">Random forest</a></li>
  <li><a href="#prediction-on-the-original-data" id="toc-prediction-on-the-original-data" class="nav-link" data-scroll-target="#prediction-on-the-original-data">Prediction on the original data</a></li>
  <li><a href="#step-5-estimation-model-quality" id="toc-step-5-estimation-model-quality" class="nav-link" data-scroll-target="#step-5-estimation-model-quality">Step 5: Estimation model quality</a></li>
  </ul></li>
  <li><a href="#further-support" id="toc-further-support" class="nav-link" data-scroll-target="#further-support">Further support</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gisma-courses/LV-19-d19-006-24/edit/main/reader/cd-1.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gisma-courses/LV-19-d19-006-24/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>In the geosciences, remote sensing is the only measurement technique that allows complete coverage of large spatial areas, up to the entire Earth’s surface. Its successful application requires both the use of existing methods and the adaptation and development of new ones.</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In geospatial or environmental informatics, the detection of changes to the Earth’s surface using satellite, aircraft or drone images, known as change detection analysis, is an important application. These results are often linked to biophysical, geophysical or anthropogenic processes in order to gain both a deeper understanding and the possibility of developing predictive models. Methods of image analysis are of outstanding importance for generating spatial information from the underlying processes. Since both the quantity and quality of this “image data” are playing an increasingly important role in environmental monitoring and modeling, it is becoming more and more necessary to integrate “big data” concepts into the analyses. This means performing reproducible analyses with large amounts of data (&gt;&gt; 1 TB). This is essential for both scientific knowledge gain and future societal challenges.</p>
<p>As already explained in the introduction, we start with a scalable change detection analysis of forest damage in low mountain ranges, which is a typical application-oriented task. Scalable means that we limit the analysis to a manageable area, the Nordwestharz, and to two time slices. However, the resulting algorithm can be applied to different or larger areas and to more time slices.</p>
</section>
<section id="goals" class="level2">
<h2 class="anchored" data-anchor-id="goals">Goals</h2>
<p>This example shows how change detection methods can be applied conventionally to individual satellite scenes and in a modern way in cloud computing environments using <a href="https://cran.r-project.org/package=%20rstac"><code>rstac</code></a> <span class="citation" data-cites="rstac">(<a href="#ref-rstac" role="doc-biblioref">Brazil Data Cube Team 2021</a>)</span> and <a href="https://cran.r-project.org/package=gdalcubes"><code>gdalcubes</code></a> <span class="citation" data-cites="gdalcubes">(<a href="#ref-gdalcubes" role="doc-biblioref">Appel and Pebesma 2019</a>)</span> or <a href="https://cran.r-project.org/package=openeo"><code>openeo</code></a> <span class="citation" data-cites="openeo">(<a href="#ref-openeo" role="doc-biblioref">Lahn 2024</a>)</span>. In addition to classical supervised classification methods such as Maximum Likelihood and Random Forest, the <a href="https://cran.r-project.org/package=bfast"><code>bfast</code></a> <span class="citation" data-cites="bfast">(<a href="#ref-bfast" role="doc-biblioref">Verbesselt, Zeileis, and Herold 2012</a>)</span> is used, which includes an unsupervised method for detecting structural breaks in vegetation index time series.</p>
<p>Other packages used in this tutorial include <a href="https://cran.r-project.org/package=stars"><code>stars</code></a> <span class="citation" data-cites="stars">(<a href="#ref-stars" role="doc-biblioref">Pebesma 2019</a>)</span>, <a href="https://cran.r-project.org/package=tmap"><code>tmap</code></a> <span class="citation" data-cites="tmap">(<a href="#ref-tmap" role="doc-biblioref">Tennekes 2018</a>)</span> and <a href="https://cran.r-project.org/package=tmap">mapview</a> for creating interactive maps, <a href="https://cran.r-project.org/package=sf"><code>sf</code></a> for processing vector data, and <a href="https://cran.r-project.org/package=colorspace"><code>colorspace</code></a> <span class="citation" data-cites="colorspace">(<a href="#ref-colorspace" role="doc-biblioref">Zeileis et al. 2020</a>)</span> for visualizations with accessible colors.</p>
<p>This study employs a variety of approaches to time series and difference analyses with different indices, using the Harz Mountains as a case study for the period between 2018 and 2023. The objective is to analyze or classify the data.</p>
</section>
<section id="information-from-satellite-imagery" class="level2">
<h2 class="anchored" data-anchor-id="information-from-satellite-imagery">Information from satellite imagery</h2>
<p>Unprocessed satellite images are not necessarily informative. While our eyes can interpret a true-color image relatively conclusively and intuitively, a reliable and reproducible, i.e.&nbsp;scientifically sound, interpretation requires other approaches. A major advantage of typical image analysis methods over visual interpretation is the derivation of additional, so-called <em>invisible</em> information.</p>
<p>To obtain useful or meaningful information, e.g.&nbsp;about the land cover in an area, we have to analyze the data according to the question at hand. Probably the best known and most widely used approach is the supervised classification of image data into categories of interest.</p>
<p>In this unit, you will learn about the classification of satellite image data. This includes both data acquisition on the Copernicus portal and the various steps from digitising the training data to evaluating the quality of the classifications.</p>
<p>We will cover the following topics:</p>
<ul>
<li><a href="../reader/cd-1.html#theoretical-principles">Theoretical principles</a></li>
<li><a href="../reader/cd-1.html#change-detection-case-study-harz-mountains">Case Study Harz Mountains</a>
<ul>
<li><a href="../reader/cd-1.html#setting-up-the-work-environment">Preparing the work environment</a> - <a href="../reader/cd-1.html#step-1-retrieving-sentinel-data">Retrieving Sentinel and auxilliary data</a></li>
<li><a href="../reader/cd-1.html#step2-overview-unsupervised-classification-k-means-clustering">Unsupervised classification</a> (k-means clustering)</li>
<li><a href="../reader/cd-1.html#step-3---generating-training-data">Recording training areas</a>.</li>
<li><a href="#supervised-classification">Supervised classification</a>cd-1.qmd#step-4—supervised-classification) (Random Forest, Maximum Likelihood)</li>
<li><a href="../reader/cd-1.html#step-5-estimation-model-quality">Estimating model quality</a></li>
</ul></li>
</ul>
</section>
<section id="theoretical-principles" class="level2">
<h2 class="anchored" data-anchor-id="theoretical-principles">Theoretical principles</h2>
<p>Please note that all types of classification usually require extensive data pre-processing. The focus is then on model building and quality assessment, which can be seen as the technical basis for classification, in order to finally derive the interpretation of the results in terms of content in the data post-processing.</p>
<p>We will go through this process step by step.</p>
<section id="unsupervised-classification---k-means-clustering" class="level3">
<h3 class="anchored" data-anchor-id="unsupervised-classification---k-means-clustering">Unsupervised Classification - k-means clustering</h3>
<p>Probably the best-known unsupervised classification technique is K-means clustering, which is also referred to as the <em>“simplest machine learning algorithm”</em>.</p>
<p>K-means clustering is a technique commonly used in satellite image classification to group pixels with similar spectral characteristics. Treating each pixel as an observation, the algorithm assigns pixels to clusters based on their spectral values, with each cluster having a mean (or centroid) that represents its central spectral signature. This results in the segmentation of the image into distinct regions (similar to Voronoi cells) corresponding to land cover types, such as water, vegetation or urban areas, facilitating further analysis. It is often used to obtain an initial overview of whether the raster data can be sufficiently separated in feature space.</p>
<p><a title="Chire, CC BY-SA 4.0 <https://creativecommons.org/licenses/by-sa/4.0>, via Wikimedia Commons" href="https://commons.wikimedia.org/wiki/File:K-means_convergence.gif"><img width="512" alt="K-means convergence" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/K-means_convergence.gif/512px-K-means_convergence.gif?20170530143526"></a></p>
<p>Figure: Convergence of k-means clustering from an unfavorable starting position (two initial cluster centers are fairly close). <a href="https://commons.wikimedia.org/wiki/User:Chire">Chire</a> [CC BY-SA 4.0] via wikipedia.org</p>
</section>
<section id="supervised-classification" class="level3">
<h3 class="anchored" data-anchor-id="supervised-classification">Supervised classification</h3>
<p>In supervised land cover classification, a model is derived from a limited amount of training land cover data that predicts land cover for the entire data set. The land cover types are defined <em>a priori</em>, and the model attempts to predict these types based on the similarity between the characteristics of the training data and the rest of the data set.</p>
<p><img src="images/supervised_classification.jpg" class="img-fluid"> Classifiers (e.g.&nbsp;the maximum likelihood classifier) or machine learning algorithms (such as Random Forest) use the training data to determine descriptive models that represent statistical signatures, classification trees or other functions. Within the limits of the quality of the training data, such models are suitable and representative for making predictions for areas if the predictors from the model are available for the entire area.</p>
<p>We now want to predict the spatial characteristics of clear-felling/no forest using a maximum likelihood classification and random forest, and apply standard methods of random validation and model quality assessment.</p>
<p>The goal is to separate clearcuts from all other pixels and to quantify the differences between 2019 and 2020.</p>
<section id="maximum-likelihood-classification" class="level4">
<h4 class="anchored" data-anchor-id="maximum-likelihood-classification">Maximum Likelihood Classification</h4>
<p>Maximum likelihood classification assumes that the distribution of data for each class and in each channel is normally distributed. Under this assumption, the probability that a particular pixel belongs to a particular class is calculated. Since the probabilities can also be specified as a threshold, without this restriction, <em>all</em> pixels are assigned regardless of how unlikely they are. Each pixel is assigned to the class that has the highest probability (i.e., the maximum probability).</p>
<p><img src="images/max.png" class="img-fluid"></p>
</section>
<section id="random-forest" class="level4">
<h4 class="anchored" data-anchor-id="random-forest">Random forest</h4>
<p>Random forests can be used for both regression and classification tasks, with the latter being particularly relevant in environmental remote sensing. Like any machine learning method, the random forest model learns to recognize patterns and structures in the data itself. Since the random forest algorithm also requires training data, it is also a supervised learning method. <img src="images/Random_forest_diagram_complete.png" class="img-fluid">!</p>
<p>Figure: Simplified illustration of data classification by random forest during training. Venkata Jagannath [CC BY-SA 4.0] via wikipedia.org</p>
<p>A random forest algorithm learns from the data by creating random decision trees – hence the name. For classification tasks, the algorithm takes a suitable instance of a decision tree from the training data set and assigns the corresponding class to the pixel. This is repeated with all available decision trees. Finally, the pixel is assigned to the class that has the most trees, according to the winner-takes-all principle.</p>
<p>From a pragmatic point of view, classification tasks generally require the following steps:</p>
<ul>
<li>Creation of a comprehensive input data set that contains one or more raster layers. Selection of training areas, i.e.&nbsp;subsets of the input data set for which the land cover type is known to the remote sensing expert. Knowledge of the land cover can be obtained, for example, from one’s own or third-party in situ observations, management information or other remote sensing products (e.g.&nbsp;high-resolution aerial photographs). Training a model using the training sites. For validation purposes, the training sites are often subdivided into one or more test and training sites to evaluate the performance of the model algorithm. Applying the trained model to the entire data set, i.e.&nbsp;predicting the land cover type based on the similarity of the data at each site to the class characteristics of the training data set.</li>
</ul>
</section>
</section>
</section>
<section id="change-detection-case-study-harz-mountains" class="level2">
<h2 class="anchored" data-anchor-id="change-detection-case-study-harz-mountains">Change detection case study: Harz Mountains</h2>
<section id="setting-up-the-work-environment" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-the-work-environment">Setting up the work environment</h3>
<p>You can either use the data saved from the previous exercise or define, download and edit a new area. However, the work environment is usually loaded first.</p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 0 Projekt Setup ----</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">"pacman"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("zivankaraman/CDSE")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># packages installing if necessary and loading</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(mapview, mapedit, tmap, tmaptools, raster, terra, stars, gdalcubes, sf,webshot, dplyr,CDSE,webshot, downloader, tidyverse,RStoolbox,rprojroot, exactextractr, randomForest, ranger, e1071, caret, link2GI, rstac, OpenStreetMap,colorspace,ows4R,httr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#--- Switch to determine whether digitization is required. If set to FALSE, the</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>root_folder <span class="ot">=</span> <span class="fu">find_rstudio_root_file</span>()</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>ndvi.col <span class="ot">=</span> <span class="cf">function</span>(n) {</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rev</span>(<span class="fu">sequential_hcl</span>(n, <span class="st">"Green-Yellow"</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>ano.col <span class="ot">=</span> <span class="fu">diverging_hcl</span>(<span class="dv">7</span>, <span class="at">palette =</span> <span class="st">"Red-Green"</span>,  <span class="at">register =</span> <span class="st">"rg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Please add any missing or defective packages in the above setup script (if error messages occur). On the basis of the available Sentinel data, the first step should be to identify suitable data sets for a surface classification.</p>
</section>
<section id="defining-the-area-of-interest" class="level3">
<h3 class="anchored" data-anchor-id="defining-the-area-of-interest">Defining the Area of Interest</h3>
<p>Please note to project to three different CRS is for this examples convenience and clarity and somewhat superfluous. Only the corner coordinates of the sections are required and not the complete geometries. However, it creates more clarity for the later process to already have the data needed in different projections.<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># download the Harz region from the UBA WFS server</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># nre_regions &lt;- "https://geodienste.bfn.de/ogc/wfs/gliederungen?"</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># regions_client &lt;- WFSClient$new(nre_regions, </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                             serviceVersion = "2.0.0",)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># regions_client$getFeatureTypes(pretty = TRUE)</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># url &lt;- parse_url(nre_regions)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># url$query &lt;- list(service = "wfs",</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                   #version = "2.0.0", # optional</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   request = "GetFeature",</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                   typename = "Haupteinheiten",</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                   srsName = "EPSG:4326"</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                   )</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># request &lt;- build_url(url)</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># nre_regions_sf &lt;- read_sf(request)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># harz = nre_regions_sf |&gt; </span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(NAME_ORD3 %in% c( "Oberharz")) </span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(harz)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># harz_bbox = bb(harz,projection=4326)</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># harz_32632 =sf::st_transform(harz,crs = 32632)</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># harz_bbox_32632 = bb(harz_32632,projection=32632)</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Download training data which is also used for the extend</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">download.file</span>(<span class="at">url=</span><span class="st">"https://github.com/gisma/gismaData/raw/master/geoinfo/train_areas_2019_2020.gpkg"</span>,<span class="at">destfile=</span><span class="fu">file.path</span>(<span class="st">"../data/train_areas_2019_2020.gpkg"</span>))</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>train_areas_2019_2020 <span class="ot">=</span> <span class="fu">st_read</span>(<span class="fu">file.path</span>(<span class="st">"../data/train_areas_2019_2020.gpkg"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `train_areas_2019_2020' from data source 
  `/home/creu/edu/gisma-courses/LV-19-d19-006-24/data/train_areas_2019_2020.gpkg' 
  using driver `GPKG'
Simple feature collection with 87 features and 3 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 10.21106 ymin: 51.84931 xmax: 10.39679 ymax: 51.94446
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mapping the extents and boundaries of the choosen geometries</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tmap_mode("view")</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tmap_options(check.and.fix = TRUE) + </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   tm_basemap(server = c("Esri.WorldGrayCanvas", "OpenStreetMap", "Esri.WorldTopoMap","Esri.WorldImagery")) +</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   #tm_shape(harz) +   </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   tm_polygons(alpha = 0.4)</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#--- Reading the data from the directories</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="do">##--- This describes how to process the Corine land use and land cover dataset</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="do">## The necessary file can also be downloaded from the repository</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="do">## An account is required for the download https://land.copernicus.eu/pan-european/corine-land-cover</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Therefore, download the data manually and unzip </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="do">## U2018_CLC2018_V2020_20u1.tif into the data directory </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Then continue</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/corine_harz.tif"</span>))){</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  corine <span class="ot">=</span> <span class="fu">rast</span>(<span class="fu">file.path</span>(<span class="st">"../data/U2018_CLC2018_V2020_20u1.tif"</span>))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  corine <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">project</span>(corine,<span class="st">"EPSG:4326"</span> )</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  corine_harz <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">crop</span>(corine,<span class="fu">vect</span>(train_areas_2019_2020))</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">writeRaster</span>(corine_harz,<span class="fu">file.path</span>(root_folder,<span class="st">"data/corine_harz.tif"</span>),<span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>corine_harz <span class="ot">=</span> <span class="fu">rast</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/corine_harz.tif"</span>))</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a forest mask from corine</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Agro-forestry areas code=22, Broad-leaved forest code=23,</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Coniferous forest code=24, Mixed forest code=25</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">22</span>, <span class="dv">0</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>       <span class="dv">22</span>, <span class="dv">26</span>, <span class="dv">1</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>       <span class="dv">26</span>, <span class="dv">500</span>, <span class="dv">0</span>)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>rclmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(m, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>harz_forest_mask <span class="ot">&lt;-</span> <span class="fu">classify</span>(corine_harz, rclmat, <span class="at">include.lowest=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(corine_harz)<span class="sc">+</span><span class="fu">mapview</span>(train_areas_2019_2020,<span class="at">zcol=</span><span class="st">"class"</span>)<span class="sc">+</span>harz_forest_mask</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-bfbbc576222cbc3aa7e8" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-bfbbc576222cbc3aa7e8">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAABfCAYAAAA075OVAAAgAElEQVR4nO2deYwlx33fP1XV/e5j7pm9V7vcJZfX8hJJMaR4SIoMHYbtAJbsXLZyCLZi2HBiIzYCxIEFA3HgBLFl2LAVG0LiA5JjJIKpRDYlMZQlihSv5bXLPbm7nNm538y8eVd3V1X+6On3+r15b+bN7CwpL/YLLGanp7q6un51/H7f3+9XLV55+HM2CCS+L0mnAwA++cbzHJX7uVdPoJDU0QBkUNyWS7FvJCCf8+gH2VwNx9HUqil8X2Gt6Ou+q8GXXrc7Wt+cqLEkahwxQ81r52WJQ2aw+fv7c1miN7tYCZixjR1tw2ZwABzH4DimeXGPHGOJCgMiwa2DDs8sVjio0ty5x1LI1pBqex3lOBpjJABayy3fn0gEzfu2c/9W8Zy6xLxdpm490iQZERkAXpXvkCNNhRxZXOJD09Pg2633z62JDPsGYbEieHO1QYVgS/df+964gXcFTueFWs3hXHCJR9VxclJybknjIrn/UEAqubVR0gmlLEppjBFbnlGOo5HSImW4zG90/wGV5qKu9V33pCyzIKoM2jT7TAGAt9QCZ4NLWMLZVafG/xEvAWCDcPWyjuU+vZcMTnNWvl3zWMLf0rsBFFOCidEqY0OC/XWHly+nsRZmtd/X7GwTZBBIfvntC+xzdnGPGSXrSl5vVAD4v2cU946kmRj2cF3ddwPrtSSpdINUqkG1msJxDFJaEokAz1s3jtZBKYNS4T3xdm6Ew4OC+Xmnrw54Tl3ispmhruukZIpTMg/AnF5sChHAYrG2/b132SIKwW430by2O+FiPVjuIswJkSSnFBeCcJDpWP1ybSRIZUklNR+4KXzWc2eTnA36FGRpKcnpWcnr3ioXmOIPxh5jekXwWr3SLLiMzzfnfW5ayvD3bul/tGst8RouiaTfpuhIaRHCbqr8GCOQHXITYuM9aO94nVwqwevTLueDjdvaNutMnTr1DcvH8aw9xWk1wEP+IR5JhjM5lxAMaAdfG6q0Cz7vKAaTgpzO4GnLpBcKe7VjwD15qvXCFfrra/WwfuzXXlzwOaNXeVlN8jn1fqoNuNBo4K+9oAAGcEmhOFRwGCpsbekwRuIoi1IGYyTWCoSgOcs2FmZYVq0pWEEg0VqtXbcIEbUwdoeAdEqzZ8AwYjPM1gwKiYNEACZW9lUubuld4ghsQNmsUnYC5nzBAZHDlZBzBUueod72JBhWLmlHoCQklGAkoRhJKMqepe7DykoS33NwjMOloE4d01FDb9xQdq4TOC9WwuXzwdQAH1QDvFapsUslOZRMNQspCbcfqCOFRcj+l9U4gkDiugG+7zb3PCkt1hqMEVu2LyPlx1rw/e57reMY9u+qMlJ0m9emFlJ8Z7nStfx2Ma0XmBMlHtVjpJ3wPfalEowELleC0N62WCb9BpM+DEiXvRnVvP9gOsHlms/lWp1UTZETqutzNoJzxM0wlhHMVi3n6x4ukgd3QEPthO87JFMeyWSA7yt8f2uN7dwXo4Gg9eYDIJNpbQXJlXahZ2WWirk6wWo0Csl3gnkyQThonsgOkHYERZtkthbulQvGx0WS6dj0kwqUEGChjqZu+1cmARJIxFcP/5KdW4Xb9reYmu0IUYiwY3vNLiEshWIFrSX1WpIg6C3ITKZOo5Fou3f/0dcAmLl0M77nNvdXYwSe5/SlOAH4vqJSc/B9wfPTmrtGHH5/YZLn9BtYLCK23wohsdZgsUihUCgC6+MIF43GrHW4QJCUybbn/Gb2MQBqAW1KYwpFMrajVdcUnaBNR+4fQyTYnXRv7JHXC5z9u6rs34GKXFc3Z6TWss1gj2xBrSVKGTKZOp6XoF532+pwHM3w2DzZsctMnTrevJ5IeIhMyF1GMz+ClBbHaZEEm81K19UMrNnBHx+G773lUBY1HOFiMTiifenVGCwGgUQJiRLhzFNIerHNB+Wuns+vo5kXdWbFKr4wvGbOs0+O8z4zwpjNbNj2bpACAmvXMzvbhe8rHEejVMi+KNVSnOMdDyCkJZlqoJwAHThNA3/X/rdJDCywMvU+AJQTkCuskB2aAiOw9QSOExD47pp9aZs/t0vIf9mc45yZRAlJNyU+L7OkRZKb7DhvcYUlu9L8W0K0BqJA8lHuZNAmOCTTrTIK9skUl01onwYYvi1Os6AXm2XusXtRsSU9wOD0uVjOW495z9s5QVorMEaiVDjaO4UHoAMHCJpCdhyNNQJnrRWLs7spBkncRAPH9SkMLpIemQJpsYGisrSLoX1nmDl/K34tidbbJ889T/HChQTnzZWeZR4Sx3hUjXHrLkPCMZTKE/zO4iV0zLpbosK0mcdieFac4zPiLorJmFAMzJjW3D2hrrAQLLY950lxgnvF4SY9+Jqa5rjexYKoM2rT9AOnvJro2yW1GbSWSGmaxnsnQndZkkTCx3E0oouwV0pDDI5eYXTPOYQTNIVIoMgOTbF4+QiNemLbAgwCyeWZFH+2PM2z9hQASZHkYXuUu+Qgf84pftzeDMATtzYgxqwkEprPNA6gY1b6XM1w2lZ4UpzgAXuIvBu2a9WzeAZSSuDFBD9m8zjOTW1tOmumOCtmmFerAKRIoLF8077Kp3igr/e6oexcJxBPHvk3dqjgN53KV4vQ2O8+K+t1FyEsrqtxnAA3EeB7DsaEpsjIrkkS+QVEor0tjYVxZt7ZC0AQXJ1z+vun03xBv8KiWW5e+xke5rH3WTIZn4VSiuHB3nyr5ynmSgkqDdGcmdrCpWrAwWzLC3KpEjBnQ7u8zsZ2YUnUeUG8zYyeA8ARDgWZp6SXGFKD3MpeDpjihnU4dV8wU0pwcIcEqbXEGIExoSCj/TDytVobarWOA77nYG1rUVicmSBby1LYfQGkBSPwVwZZWRjtyd70i5DnFXwtmGLRtoT4cXs394wrMplwCd1IiBAur9m0oe4rluuWcmCoW8u8bZCshlboUFIxvRYhoDcRIsCgTeHIll0d2IBFXQJgQS9y0UnjSU2eJI+o0bZ7o351DkzUqdV3TOdZq1w0GRdjwp+Oo3HdAGsjbXM9IWCMorKSJz8hEVJTmdnPSmngqoUY0XkgecGeCa/hcECO85nDKRKJ/mlH31fMLysqHpz16m373ztrmulCbesUWycEgoIq8IvqQayF58wCDaF56Ob1bZ1fTOE4jtkxZacbrBUoZWLejvVLbjpbJZUO2Q8hDUKGnRMEbleB9wshQo9LECiUMrxyJgfAqBzkE/oWfuSoQar+6bDSUpK5FcV8LeRNb061NEptLCe9KhbWua82w5RcpdYR45OVWb4w+iATo6Hg7qkVCLSELtZrMe/fUHauF+zsmrqGSOEJghZJ0PXhrk9xaJ5kMdzkMRKRCkfc0sUjVFdzzaV5K3Ac3fRVRg5spSxP18J9x2DR2L6CyGo1h4avqDckl0uQcmDa97hvMMXxY2G7hbR4jQST38+wsubFvcnJcHTUUqpInl3ZmJT31phWgWgyrkooRgZbs3QjZXRl1b02goQoPmdjBWp0zzl0kKK+NE69msNrJCgOzQOwtDjQpPSk7Ne9Gg6ieERg1JbXzxSZlBfBwF47zMcPKdjEbXv6UoYvr17hdS5jseREhn9mb+dDBxTFfJVKJY1SBjfh47o+/+C4x/Oncpxt1BnNCG46PEdpIc/F1RRTprcSddAMMCKyvOXMMmNLLOoS1hrOT6Vw13aWwbxmoNA9xLJSl4hXHv7cumHZzZPQ6UbqZQJ0i7HphVS6hu+76MAhna2STNUoL4dqtu+5Tc62W3vCfdeSTHkUhxYozY1taJb86ksVXrbnuU0c4Ccz+zh+ZAVrxYZemF88OcVrwVkApFD8ivoQjx1bLxClDLl8tfn7+QsjZDMB4+NLAKyWM/zRif5Xlv9hv73u2mfEo/zE7b379MYeeZ2g69IaeROiYGIhbNtypbVYF2gc2YtS9jcbAeq1ltZXr6YxWjE4OkMiv8D02dsAp7nXxpHJ1CkOLZIuzIKjEY4mVQj3q/L8XspLA23lT18o8lGnwLCf4Sh57jq6grW9edogkJyfSnFaXwZgWA3xYXNs3Wx03YBcoUIqXcFrhBEV+aFpbsuu4nuJtT5UGCMYItGMlDMWRl2H2/ZogkDwt+8Yyvj4WBo9NN4yPquVNLls93gpp7yaIJ0K2gQVCamToYm8+uH1KFwjvK+XQhMhEn7noAgCuaaMQKOeJJgbZ7w4z/DEJEa71CoFqqtZhLAUh0KyOTM8GbI/a892HgvJeIyh+OoJys882qx/dTXJiYXw5T+9p8Cu8dV1brY4/vR1WMXjK/ZpAB5St/OpzF5uPVhdV3b3wXPoIInfSDNw4AwYAdKSzYacqammWV2awFrBx48FJJJBc5uIFDCAHx2RvPV2nqUaTDW6C+pNNcPJyZt4/9H2vzcdEFcWHZR0OLy31dB4WL4xLWUjuh65jqztTZB3whi5Ltw/DNWI9sBQSdGBw/z5YxSG50gWw38DazNSZBrIiWUQFnlsCLkvJLfFaMujGjzz9bbnJpMBP3a312xno+H03EtXKy5/bL/R/P3fqo9w/35LPrdeiADKrSGVRyJbCt1snotI+CAt9bldlEvD1GrJNQXMNsNTOm1pxzEcmKizR0tuAxbPPMJXxSusmDI/Ix7nBTXDB81uHrl7ZS2KUDZXzei9nOW6pZDsvRF3G73RTOxXiJ2IOjJifyKlIxqlnpdg/soeMuUBCsNTqHwZkW6g7lOoez4JbrJn3c7dVXi19XsUTK11GIJSWk6RcExbHA/Am29n+IvqFAApmeJD3METx7wNY2hnLx9lYGSWZG6G+twuSnNjTBw6iW5kWJydIAhkkxsWwqJ1d60a4Km3HP5avs2sXWZcDfIT+j7+UDzDJ47CJxjHUX5zAkmp121fN5Sd6wRO2hUMZLc2s7YzGzuX526IO6YBqqtZvMZBJu7/Hu4P34UYP7j5c+5+CL60/roQ4HkOVxYVrlKkyy09r9IQ/Gn1Ms/pN9jv7OHnEndw1+EqjrPeDhbCMrprGiEMbmoV7SdZuniESjlMNViafl+418dmI9AMdQlJkvUz8pN3VTnzyjAP2338Id/mVXsagJnFBEcOrqC12NDf6wxmLPlMf56PaF0W2/AiRXtkxH9CfzE2Q+OTqNsTGwuxUUW/9DQA9a+NAofWFZHSMr8YLsm+Br8m0BZOVup8Q53nkpkOn0eOuw5Xw8i9W14NFZg1WKPwakWcNZJ9dWmcajnbxgdXV7NhWSuaPHM8jhcgmy+TG5hr1WslT/71cX7jo2cp/qtpfv4PxvmpvxrkRXOa/buqa96k0Kvkuj1YskJWr9sveiFq2HYQ3RcnC4SwbaM2zuCk0jVGn/gO6pH7kBP3hheNxlaWEJkC1m+A38BePIn/N6tMnngAKTWFwSXS2Sq1SiuQafJKHmthtS45u+rzspzDx+ALzYv2JPHUix9XB4lHBURBXxhB6eLNbfVuhGjQxs2x6OfoZ99B3v5wW/lPfR7gFgDyvwFf+ewbfPufP0YyWW5aC46j0Vp0n5Fb8Xy0KLOtKznxlLgInU7i8P8hNzrxC1PIg5+EZNhxtr6Kef1ZVv58H4Uf+S76DUv5rWN4jQNYI0ilawyOX0RmaniXjuK4PvVaknrdZaEsm07gPSmXxXqRp+RbTAez69q5Z6DVFuMnUSkPW09Qnt/LylK+70y0SMEJTa5Wn+3/1DeQt//4pveLXJEHHn2WiyePY0zLg9QLN5Sd6wRbJs3DDXdr/rZORLGvcUUgThRIpZE33x8+76VvYE4uYldSvPPcQwCUvjiKlJpUpk4qXSEzcbmt/vzgDCuLE1RW0yyXE23BUmkH7s9lGa3cyX/hqXVt+5WFV/iJuTv4odvClSoyK6rVFK7bny4RN6tCIkRw+EPfBGmRdx7f5O41CInIV5vKYeRT7bUibEuQUZDwdpbYeD3QIuN72Wt2dpHS8/exulxoloniXTPF6XAPMwJTDek+ITXzV/bTqCeQ0jI+WmF+JY/pqH53yuGztcf5Q55phv4DTAUzfEEs8fTJQ/yWe7SNWPd9B2N6d2aE+BKolGFodIHEZ34YZBeC3mhseRGkRKRyTRtZDO0m+bPDDJyao7KaWVdvJ7blxoqM9418jZ3QOsxzjOeGtNLJW3kcxghELBtJ7t9Dcd9ZKit3k0i29vNaJYfWe8jqOWS6SnVljPJSEWMU1UqCuVKKhi8oZPU6IUKYOHNbLsmj1Tv4vj3LqBykZhtM61katsEJfYa5hcfbXEfRyrEZrG2VLQyUGXjgRZCH28ssTmEnz2LLKyx++RgAwz/9GvL4Y60yfgOvkeirj2/skdcJ+p6RnSNxMy0qjrgdFNdSozqjmRhpxYXBEjACgH5pisnXH+86E7x6GqWGQrts4iLlpTsxRnBpJk1tbfJWGhvH/PxoZoI7VocZlQ5Vbfht+V0MFt96rFQUuYxs7t2dhH+EuEMgQjLpseuWV3E/llqnpZoTT+M9aZk6fWfb9cI3zuKmnm/qB0I5JNONvkyevgQphCV5FfmSvfIyukXHFQeXGfr8OADm1PfQl4ab5whYIzBWrCXcRnuraasvCBTphKXm9c9a3JQLcziKKH658TDTvsfv2W/xS6Xn+MmFu/ngXpfBgfXe+YjAhlZISYS9H/sW6iNPIIrt4Ytm6gwzf3C4q3AmX72P7IUy47+zdiGZYejwt6nP7AFoeoK6oe+lNUpO3U4MTSfCeBrbdZZJpUODv1LC+19Vpk6Hs6zRcKjVkmsnaLlYI0LBGoWtJlm4cAtBoFouOBFmWqfc8Gf078CYz0jeIEXrJI046trwnArzQRZ1id+13+L5yTUPQ8ds7GRvfN/B90Pvihh01wlRP/U/WfhNueEMK45fxEyfQz/7NQCSP/8EuR+7TPaxNxnYe7bnfZvOyIhS62QntoPOuqCl/EQ/I3bH+90XmT13e5NjtFY0Z3C97hIE4bVqNcXi3HDzb1OzoYN3pGAo5Px1/r902iPvK4r5sI6Ls+2pfRVjuCzDuKF9zi5+iju4Z3+opfq+WsdsxRW2xFqEvJQWed8jrUKNKvX/+AIzlx5eS2Raj/2feIrqi8eoLY3j/dcKyhkl+wEI/vdfsvCtB5pcbieiZf2GsnOdoDk8otkSD92IhxTuBLr54jpNj3o1i/9nX2bx4gcIfBelQqdzPNwjSuGLlub4XpvLaIr59bRjIhE0n6WUIZ328T3FaCGst1yT1H14eK9kYvZeflV/nc8P38nusRbv2umbjdcZf5c9934PUfx487q59CZT52/bsG9mnnqkLQ9m4kAYEa8+8mHyJ870nJFXZnIsVyVOtPREnbwTS2gnwhSBjQ86ipanRj3J5a9/aNM6Iy95Zzu7CbFTO46Wcqkso8OhoIYCiTaSRCLg9qTLf77yQ4x0UXDiiJ8dmCuu4LoNCp+6iLzjUWylhHn+aWzdR75v45xwYwS1aqrtXaxR2PoqIj+MTJ9ASt016j7QAi8A6Tia8F8UPHV1jE03uK4mmQy25MMMAtm3YhUSE929MpHGHR7joggC1UYPhplhGuWY5h6Xy3nccahKIrExgxMEiiCQFIcWGf0PGQb+3SDq3g8jUjm833uBi1/6IPpsdy0TIqpS4Ptqbba3KL25yQNUPv8W+A2S/+Iou2490bOeXMrihJ27s4LrF3FBdSpAcfaoGyKtNz7wooi7OIcbCbhbOl6keEVKTHzF2MgBHs8pCQJF/tbXsZVbCf7qrWZA2LkXngBg5dwtFIIzPeuKNF9oufSUMmSyHql7zmL9I4jhvYj0K13vr/uCkeKN3I/rBuKNxz9rtxtEdbWIG9SdvG0U7Ral4sWVnc5k2rizNR4lF81Ia9fPyLjnPn6wRKdnphPxVSJithJJD8cJWCoV1pXfyGMBrXOC4rjp8adxPrIfkmm8/z6JruRZnt/VFgesteDiZKgATQzXcbYTtrETiDpP6/blJYLj6Kbwuu3ZQsRsqFhkgePoWH2hQhItV5GAooEgpSUIZPMErX6yoeP2bCoVRlaEB0B1N/KjfbDbZIkGThwHb34T52NH0P/vDaaefgQdjLT93XF9lDJMXxlgdNBjbGKRCxfGcHZasdkM8VEPvXNIogEWGfNxRFnR0d+jbOR4SES79m2b98UN+PhevNV0diEsjcbmDGdkKpmYLhbN0NYxbGFf3PTRp7BGUP5CjoWZx9fVJaVmZPfbSLcBHGH6ygDnz40xvaRu7JHXC65ZWh20Lx2t0yBpLplxjbRzZYhstCjHshPxGRRpndE1IdptvLCe1gpgTMu473ZqVpwc6XWunuvqvk6Ajvohvm93Ipqhs9/7QGgedaHxkqkG+cF5VL6MrYd5JZdmE+HZtImYICPH704ttWHjWx0UP3os+n83l1CEeKe2uNZQGJ32XXTAhOsGCNESbPxdojrip0lGZbodtxb3ZsTTHSJst5+6CTKqq1FfH0E/NDaDEIZkfgGR8NHlPLOXD/HyyfDTFcN5w/BgHeeLL7h8YCDD4b3VtpjTCPFkk34QheZH7EkyGTRnw1bqchzTFi4ZBJLF5QQrNcFoQbe5laIZEio2rUGwUWdH2mRnLkg8fDFqa7S/RX0TrTJxSnMj9HscaTekhqax9STGT1KZ30t1NUcQONx8IMxHcd2QaHFGRYKRYshodEv8DA3v9VRYL4RKSpTuHV7baObFEdfgIoUmzsAMFT1KlSTTS4pcVpFOe82y8fKd1F2nZhgnCqJ3bF3v4lqTLXPHrLnO+kWkIUeDsts79+pb5QQIaZifOoSbbBD4CXTgIKVtaszNNvbdohv4gYbz92/1NySzw72ppXBstjRezR4bP1V5M3MglfJj3pmobWEdnUeBRhEKLUqvtXzGjfWeMyP2zlKG3G0y1aBez8XKtGZ5tDpEe208qdb3VTPaIrJdk8mgaZJJadhzKMz7EEIzffoOhsamqFUGSGUqXfdRAOfXT5aoi7DiPabAp3cXGCw02k68iJbc8JNI3fnRnUAv4VkrmF1IoU3o5d89HC4rYdJPu1LT+mxTa5mML8/r0tG28A4DwwsEgUtlJY+bbAAtQbanBrQGR7Tcd1Nywq8nmCbDFTnWVb4ctttzqFZS5BtZvFoYGdELjofm+8GbTKgx9tsiX52s8kmbYWSoPc262/4p5XqP/0aImyJbwdJygsXVNWEoGByo9dSwQ/9l+/W4534zSBl6Q4wVBB0dlxl9h0ZpjIXZIer1oa4RD93r7O5Riq7FY5qCQDF3+nYAtAnNo6WF4U3b7fzj7D78qubXD+/i2IPP4i0Nc+bkzV0Ld86YyOUSH20bKTadgoy02c1cZ8GaxpdwYGwg2NRM6uW87gfDE5O4qTKVpV0sL7a+TpdK12iUxpi6tA+g72C0jZ4d2dmuq/F91SxbLmeaA6RfLf+GsnOdwDl+8zKPvriXYw99G1tNsrI4TioZkEr5SKmbkWG9EI8kixDfR3t9FiIkrMO/9cqpmJ5L4wWhBxzCZXV0ZGe/2RFBOQGFgRJuoQSeg+OGR3UPDM8hpMFJVFm8cqBv27EfRCtREMi107qiaIreJkkvOAD/8INrR3FlGgwfPEVi+gD5kXfwKoMszkxsKMjIGI+jpYF1J6PDjmgJPqLNOjup7otmoDGANrC4GHoZhoa6H9CwHWRyFQrDU1ijKE8fIPAT5IrzjB88hW5kWFmcwGuMowOnLRxmu+i0azuJku3U70B4ylRjYZxyaQStJaN7zrE4eZjVcnbDk6GgZZ50NrSTDuu8J15vpBFL2foqTzgb2++r+zTDF2dKRXaNeAwUt/dloDgGxt6mujzB6kqhqeDUKvvJFVfWZSTD1Wvr8cHa4nuvrs4be+R1AnHqw//SQsiuu8kGpfnwu8Hb/XRuvx6BbkilfLQWeJ7LmcvptrzGTvxR7QLH9Tif2J9kYmx128+E0Fmrg97n7+wEouU07kuNcDXpGBGa0mrUk6yUis2HbRX9pJttlCoQKUu+7zSN/7aGdvTxMlW+ZJ/hby5t/eupnQh895oJMXReSzzPwfOctiiFZDLYESFCTJCdnvvNEB1tHVFTkS0UGcndcgldV8f+hS/Q6XFx3YDxkRrFjEWtNSXlwv4xj1zKku1gqL4iu0eXvdeIBBiFYEJrILtucNX7bCdi/sjo+I+g6d/baJTGaa9mZTEVOnqZKJwC1oc8RvxtnBAIz3n1ObTfZ3Exg68FhZxPOu0xOFhDa8HcQhZ3MqyzpMOjNMvlFE++tebDBN4/5nJof+urOe82OlMI14ef7CxuKDvXCZozMqLaooDlyHPebamNPPGd6KSTopnWi2eMgoN7qd69bEWtBZOmdeDQz728SB2PU/YCALudccZLd3FoJ77etk1ENGEUKXGtQ06bguzcdK1db7hG2PrxZb3Lb+UL6gClpTQ/PfW31ExLyK8Eb5GTOT4q7wPgF47kSCavDQMEYVrfWxczHL95edOy71aUYldbIdrXuqWJ9wrhv9b4Ty8ayqJBjXKbEAHucW7hn6YPcs8tUcdunHyzXRgjuDyV509mFvgOL/Mkt1+T52wHXffIzlRxx9FNVfndjkoPncGao+R50Z5DAg+q28nKVnLMT7UJ8eqQTIVfyuvEzFyWr7yU4l/PvsSr8h1+f+IDTF7JU6slutTy7uOGsnOdQP3swft+LeI+w4ho2czDj7BZetm1hOMGOK6mKNMML+9lD1l+/l7Jvvkj3GkP8qA4xBf166ipPdyy++rIgWy+zNChU7hC0KhnsGv9kCuucO7tQcoe3MUEt9kxLpQ1v1H5PrNzA+w1xZ6fcni3IE488rMWNo6R6czMfTcR5TpYE54XMDefYddEOyX39uUCSdesu75VjO87j1Ncwl8aoloewqulGBibwklUIBEgHI0u53nxe/fw6Xf+unnf58QTfPq+qyfvrwbOZtRUlM30bkOtHXor15SsMOyhu7AO7ttZw98tlCgWStTmd2O0y/w7R0cN5/AAAAIQSURBVEjnVnnuhffxRsnni3y3rfx/E9/l09y9o23YKm7skdcJ+jqeRQjWvNjbO3R3q4gCoCJYIzD66j/ltxmMdrCBQkgTfg547Zo2kuXFIf6iNM/XzQvN8lmZRSD4qL3jmrdtM/QUZER6b8TO7ASi0MHog6BSaVQs31Frec1dTBEWpveQrRZQSjc/7QRw8swwlQakWWor/0/s/TwwmmD3WJ1unwN8N9EmyHg27rW2F4WwKKf1BXStZXM/hHAWhpr0tZ+JEYxRbV/xCQLJn7zi8pfyOUp6qfkluQi/Z7/Fcf+HmqkL7yVk3N0Uhd+920KElj9SG4nvu/j+1X0EdCcgpeWJXQl+e+x+7nCOvKdt2Qw3lJ3rBE4YCBv+8m6dJ2CtQAcOSrUvSVFIvBDmPZ+NEM7IfXvC8P0fmT+I7wTcq8OTGldE2PYok+29hhMl6LxXJ3tAaz9sKTQ/eAvFR+4qc8fs4WZ8UKMRHrXtutfOy7IVbEoIXCvEE4P8jpiZ96pNmyEe5LVTsTY7BSfKeH0voAMHozc/EuUHAbVagt96s8JxMciHbvYQkh8IbTXCD94adgPbQs8Dk3b6cIhe+LswG0+dL/LHS+/wXfM6z8gMXz09zkN6Pz9933vdshaayk50/mk8VqffD5Zc7/j3yy8zpWcA2CfH+EfqKI/e/d5F6HWD+OY3v/lr73UjbuDq8f8BJnCBxawXBvgAAAAASUVORK5CYII=",[[51.94444454499717,10.21166713945832],[51.84887689761319,10.39751161737801]],0.8,null,"corine_harz - 1","corine_harz - 1"]},{"method":"removeLayersControl","args":[]},{"method":"addControl","args":["","topright","imageValues-corine_harz - 1","info legend "]},{"method":"addImageQuery","args":["corine_harz - 1",[10.21166713945832,51.8483989805471,10.39863583825444,51.94444454499717],"mousemove",7,"Layer"]},{"method":"addLegend","args":[{"colors":["#040404 , #1B1033 7.69230769230769%, #4E1259 20.5128205128205%, #841170 33.3333333333333%, #B72774 46.1538461538462%, #E14F5C 58.974358974359%, #F58625 71.7948717948718%, #F8BD43 84.6153846153846%, #FCF28D 97.4358974358974%, #FFFE9E "],"labels":["5","10","15","20","25","30","35","40"],"na_color":"#BEBEBE","na_label":"NA","opacity":1,"position":"topright","type":"numeric","title":"corine_harz - 1","extra":{"p_1":0.07692307692307693,"p_n":0.9743589743589743},"layerId":null,"className":"info legend","group":"corine_harz - 1"}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[10.21166713945831,51.84964347643648,10.39735444628331,51.94440803302302,true,"corine_harz - 1","Zoom to corine_harz - 1","<strong> corine_harz - 1 <\/strong>","bottomright"]},{"method":"createMapPane","args":["polygon",420]},{"method":"addPolygons","args":[[[[{"lng":[10.262496,10.261467,10.261467,10.262754,10.262496],"lat":[51.916612,51.915933,51.915668,51.916436,51.916612]}]],[[{"lng":[10.257204,10.258777,10.259092,10.257604,10.257204],"lat":[51.918368,51.917936,51.918262,51.918615,51.918368]}]],[[{"lng":[10.257332,10.256932,10.257862,10.258434,10.257976,10.257475,10.257332],"lat":[51.917759,51.917309,51.917062,51.917583,51.917424,51.917477,51.917759]}]],[[{"lng":[10.245327,10.244211,10.244218,10.245098,10.244976,10.245227,10.24547,10.245663,10.245327],"lat":[51.931071,51.930613,51.930763,51.931195,51.931455,51.931495,51.931283,51.931005,51.931071]}]],[[{"lng":[10.220754,10.219867,10.219066,10.218265,10.217707,10.218079,10.218136,10.219138,10.219524,10.219123,10.219481,10.219724,10.219824,10.220282,10.220311,10.220668,10.220826,10.220754],"lat":[51.851244,51.851253,51.851103,51.850988,51.850802,51.851333,51.851624,51.851553,51.851624,51.851969,51.851969,51.851916,51.851492,51.851447,51.851801,51.851598,51.851492,51.851244]}]],[[{"lng":[10.218894,10.219667,10.219338,10.21858,10.218894],"lat":[51.85234,51.852817,51.852976,51.852463,51.85234]}]],[[{"lng":[10.221813,10.223372,10.223916,10.223429,10.222857,10.222056,10.221884,10.221469,10.221813],"lat":[51.85287,51.852773,51.853179,51.853285,51.852958,51.853073,51.853276,51.853091,51.85287]}]],[[{"lng":[10.226562,10.226762,10.227091,10.226848,10.226562],"lat":[51.85287,51.85249,51.852561,51.852985,51.85287]}]],[[{"lng":[10.212085,10.214059,10.21333,10.212271,10.212085],"lat":[51.855927,51.856634,51.857058,51.856757,51.855927]}]],[[{"lng":[10.222099,10.221298,10.22217,10.222099],"lat":[51.856713,51.856943,51.857173,51.856713]}]],[[{"lng":[10.227578,10.228021,10.22835,10.228093,10.228236,10.227942,10.227578],"lat":[51.85841,51.857513,51.857659,51.858003,51.858136,51.858387,51.85841]}]],[[{"lng":[10.228851,10.229166,10.229208,10.228851],"lat":[51.856426,51.856055,51.856466,51.856426]}]],[[{"lng":[10.245152,10.246038,10.245881,10.245252,10.245152],"lat":[51.867103,51.867138,51.867288,51.867323,51.867103]}]],[[{"lng":[10.24734,10.247869,10.247998,10.24734],"lat":[51.867677,51.867606,51.867862,51.867677]}]],[[{"lng":[10.246983,10.247555,10.247598,10.246983],"lat":[51.866034,51.86576,51.866272,51.866034]}]],[[{"lng":[10.253713,10.252769,10.253356,10.253713],"lat":[51.878213,51.878019,51.878372,51.878213]}]],[[{"lng":[10.252168,10.252626,10.252941,10.252676,10.25249,10.252168],"lat":[51.906075,51.905396,51.905475,51.905952,51.90612,51.906075]}]],[[{"lng":[10.298016,10.297644,10.297644,10.297916,10.298374,10.298145,10.298016],"lat":[51.880496,51.880284,51.879675,51.879799,51.880064,51.880311,51.880496]}]],[[{"lng":[10.262153,10.261738,10.262096,10.262554,10.262153],"lat":[51.859567,51.859338,51.859152,51.859408,51.859567]}]],[[{"lng":[10.236812,10.237455,10.238056,10.238743,10.237412,10.236812],"lat":[51.856502,51.856201,51.855998,51.856625,51.856687,51.856502]}]],[[{"lng":[10.244336,10.243049,10.243363,10.244737,10.244336],"lat":[51.914486,51.914168,51.913586,51.914062,51.914486]}]],[[{"lng":[10.247397,10.245967,10.246854,10.247397],"lat":[51.907974,51.907286,51.907356,51.907974]}]],[[{"lng":[10.243449,10.242391,10.242248,10.243392,10.243449],"lat":[51.904726,51.904779,51.904391,51.904303,51.904726]}]],[[{"lng":[10.230138,10.228937,10.228987,10.229824,10.23026,10.230138],"lat":[51.91826,51.917999,51.918586,51.918524,51.918229,51.91826]}]],[[{"lng":[10.245659,10.245774,10.246131,10.245659],"lat":[51.928134,51.927667,51.928214,51.928134]}]],[[{"lng":[10.251796,10.252697,10.252068,10.251009,10.251796],"lat":[51.927534,51.927279,51.926952,51.927005,51.927534]}]],[[{"lng":[10.26475,10.264821,10.265379,10.265923,10.265851,10.266981,10.266423,10.266123,10.266337,10.265765,10.26475],"lat":[51.918734,51.918187,51.918346,51.918222,51.917825,51.917799,51.918214,51.918434,51.918611,51.918822,51.918734]}]],[[{"lng":[10.259918,10.259389,10.259274,10.260268,10.260805,10.259918],"lat":[51.92446,51.923824,51.923361,51.923745,51.924036,51.92446]}]],[[{"lng":[10.222607,10.220575,10.220103,10.220189,10.218959,10.218558,10.218058,10.218773,10.219917,10.22079,10.22119,10.222278,10.222607],"lat":[51.870993,51.868176,51.868335,51.868874,51.869103,51.869377,51.869633,51.870075,51.870437,51.870172,51.870437,51.871029,51.870993]}]],[[{"lng":[10.238042,10.237041,10.235338,10.234036,10.237255,10.238042],"lat":[51.864148,51.863512,51.862487,51.862734,51.864545,51.864148]}]],[[{"lng":[10.232635,10.230796,10.23164,10.23277,10.232635],"lat":[51.862611,51.862898,51.863772,51.862977,51.862611]}]],[[{"lng":[10.232184,10.23154,10.231225,10.230439,10.231569,10.232184],"lat":[51.861661,51.861281,51.86167,51.861829,51.86197,51.861661]}]],[[{"lng":[10.227728,10.229244,10.228629,10.227427,10.227728],"lat":[51.853586,51.852958,51.852561,51.852676,51.853586]}]],[[{"lng":[10.227742,10.228643,10.227985,10.22747,10.227742],"lat":[51.850007,51.849433,51.849309,51.849663,51.850007]}]],[[{"lng":[10.230904,10.23046,10.231018,10.232148,10.23272,10.231647,10.23159,10.230904],"lat":[51.854796,51.85515,51.855591,51.855874,51.85537,51.855291,51.85492,51.854796]}]],[[{"lng":[10.234287,10.236304,10.236282,10.23463,10.234287],"lat":[51.85568,51.855587,51.856294,51.856174,51.85568]}]],[[{"lng":[10.281301,10.281301,10.28173,10.281301],"lat":[51.856192,51.855777,51.855883,51.856192]}]],[[{"lng":[10.283961,10.284362,10.284691,10.284373,10.283961],"lat":[51.853065,51.852967,51.852994,51.853122,51.853065]}]],[[{"lng":[10.221405,10.219631,10.221233,10.223122,10.221405],"lat":[51.941444,51.939504,51.939187,51.941162,51.941444]}]],[[{"lng":[10.225811,10.22192,10.230846,10.225811],"lat":[51.939257,51.936859,51.937776,51.939257]}]],[[{"lng":[10.220833,10.217628,10.222836,10.220833],"lat":[51.932661,51.928992,51.928286,51.932661]}]],[[{"lng":[10.237312,10.240974,10.242748,10.237312],"lat":[51.941197,51.93707,51.941903,51.941197]}]],[[{"lng":[10.320854,10.322056,10.328636,10.320854],"lat":[51.892652,51.889509,51.891486,51.892652]}]],[[{"lng":[10.315304,10.319767,10.320511,10.323887,10.32383,10.320911,10.315304],"lat":[51.90462,51.90289,51.900701,51.899077,51.902996,51.904514,51.90462]}]],[[{"lng":[10.318909,10.321312,10.320339,10.316792,10.318909],"lat":[51.909773,51.90995,51.911891,51.910938,51.909773]}]],[[{"lng":[10.327721,10.324287,10.325103,10.328007,10.332642,10.329337,10.327721],"lat":[51.931345,51.930136,51.928531,51.927843,51.929281,51.93175,51.931345]}]],[[{"lng":[10.337806,10.333714,10.332284,10.336432,10.338578,10.337806],"lat":[51.93699,51.936408,51.937695,51.937872,51.937378,51.93699]}]],[[{"lng":[10.337491,10.337234,10.33978,10.337491],"lat":[51.932933,51.931398,51.931257,51.932933]}]],[[{"lng":[10.319481,10.316648,10.324059,10.319481],"lat":[51.940076,51.935826,51.935985,51.940076]}]],[[{"lng":[10.364113,10.35367,10.355988,10.365601,10.364113],"lat":[51.944459,51.944001,51.939362,51.941761,51.944459]}]],[[{"lng":[10.365944,10.366173,10.362511,10.358419,10.362883,10.365944],"lat":[51.938304,51.9358,51.9361,51.937757,51.939133,51.938304]}]],[[{"lng":[10.355887,10.356402,10.360494,10.358319,10.355887],"lat":[51.935218,51.933524,51.934001,51.935906,51.935218]}]],[[{"lng":[10.260859,10.256968,10.261002,10.263548,10.260859],"lat":[51.940403,51.938587,51.937035,51.939486,51.940403]}]],[[{"lng":[10.341682,10.338564,10.337019,10.342283,10.341682],"lat":[51.861441,51.860434,51.861017,51.86236,51.861441]}]],[[{"lng":[10.341883,10.339251,10.341396,10.341883],"lat":[51.858491,51.858614,51.85948,51.858491]}]],[[{"lng":[10.385399,10.383081,10.385885,10.387201,10.385399],"lat":[51.883715,51.881905,51.88141,51.883538,51.883715]}]],[[{"lng":[10.365143,10.364685,10.367889,10.365143],"lat":[51.867945,51.86526,51.867803,51.867945]}]],[[{"lng":[10.358162,10.351639,10.359535,10.358162],"lat":[51.855012,51.852397,51.85162,51.855012]}]],[[{"lng":[10.379562,10.373755,10.376215,10.380592,10.379562],"lat":[51.901928,51.9077,51.910206,51.902828,51.901928]}]],[[{"lng":[10.365515,10.361223,10.363455,10.365515],"lat":[51.904117,51.902493,51.907647,51.904117]}]],[[{"lng":[10.372496,10.363855,10.37055,10.372496],"lat":[51.908141,51.907876,51.909165,51.908141]}]],[[{"lng":[10.292616,10.284805,10.28718,10.293446,10.292616],"lat":[51.915421,51.913092,51.910992,51.913145,51.915421]}]],[[{"lng":[10.26741,10.264893,10.268211,10.270729,10.26741],"lat":[51.931215,51.92931,51.928181,51.929592,51.931215]}]],[[{"lng":[10.229645,10.239372,10.242805,10.231476,10.229645],"lat":[51.930862,51.924652,51.929168,51.931003,51.930862]}]],[[{"lng":[10.213122,10.211062,10.223594,10.213122],"lat":[51.908591,51.900595,51.901672,51.908591]}]],[[{"lng":[10.387287,10.39381,10.396786,10.387287],"lat":[51.943808,51.931109,51.943738,51.943808]}]],[[{"lng":[10.334726,10.329807,10.333925,10.340902,10.334726],"lat":[51.940634,51.93746,51.935061,51.937036,51.940634]}]],[[{"lng":[10.302014,10.305331,10.310135,10.302014],"lat":[51.94395,51.937954,51.939364,51.94395]}]],[[{"lng":[10.313566,10.319742,10.325347,10.313566],"lat":[51.941692,51.935908,51.941199,51.941692]}]],[[{"lng":[10.359889,10.372127,10.367552,10.359889],"lat":[51.927652,51.924336,51.920878,51.927652]}]],[[{"lng":[10.304187,10.292292,10.293779,10.305903,10.304187],"lat":[51.926382,51.924689,51.921301,51.923418,51.926382]}]],[[{"lng":[10.330951,10.324089,10.329579,10.329807,10.330951],"lat":[51.930122,51.928781,51.931815,51.931039,51.930122]}]],[[{"lng":[10.318713,10.313451,10.31105,10.315739,10.318713],"lat":[51.926806,51.924689,51.926382,51.928358,51.926806]}]],[[{"lng":[10.32415,10.321348,10.327038,10.32415],"lat":[51.932536,51.930419,51.932042,51.932536]}]],[[{"lng":[10.329812,10.327553,10.328439,10.330241,10.329812],"lat":[51.93534,51.936275,51.936963,51.935288,51.93534]}]],[[{"lng":[10.361068,10.352918,10.362555,10.361068],"lat":[51.906367,51.898989,51.898565,51.906367]}]],[[{"lng":[10.354977,10.351146,10.353605,10.354977],"lat":[51.90702,51.904866,51.904143,51.90702]}]],[[{"lng":[10.351889,10.345255,10.347257,10.351889],"lat":[51.891556,51.890638,51.89311,51.891556]}]],[[{"lng":[10.259787,10.267564,10.262589,10.254411,10.260759,10.259787],"lat":[51.882532,51.885852,51.887829,51.884757,51.882532,51.882532]}]],[[{"lng":[10.272311,10.268594,10.273855,10.273054,10.272311],"lat":[51.866071,51.869781,51.867767,51.865682,51.866071]}]],[[{"lng":[10.24303,10.238913,10.241372,10.24303],"lat":[51.865894,51.865258,51.867272,51.865894]}]],[[{"lng":[10.361947,10.363806,10.367094,10.366751,10.362147,10.362223,10.361947],"lat":[51.869974,51.865999,51.865734,51.869249,51.869673,51.869695,51.869974]}]],[[{"lng":[10.221053,10.225399,10.239925,10.221053],"lat":[51.93065,51.922676,51.926134,51.93065]}]],[[{"lng":[10.279002,10.272854,10.275713,10.282547,10.279002],"lat":[51.932271,51.926185,51.925321,51.931936,51.932271]}]],[[{"lng":[10.276163,10.273761,10.276663,10.277964,10.276163],"lat":[51.877865,51.875242,51.87458,51.8773,51.877865]}]],[[{"lng":[10.280023,10.281067,10.282096,10.280895,10.280023],"lat":[51.882262,51.879481,51.880143,51.882421,51.882262]}]],[[{"lng":[10.289175,10.285944,10.288031,10.292006,10.289175],"lat":[51.872341,51.86872,51.867783,51.870115,51.872341]}]]],null,"train_areas_2019_2020 - class",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":0.5,"opacity":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],"fill":true,"fillColor":["#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#4B0055","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333","#FDE333"],"fillOpacity":[0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6],"smoothFactor":1,"noClip":false},["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>7&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>8&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>9&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>10&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>11&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>12&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>13&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>14&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>15&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>16&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>17&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>18&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>19&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>20&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>21&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>22&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>23&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>24&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>25&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>26&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>27&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>28&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>29&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>30&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>31&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>32&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>33&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>34&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>35&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>36&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>37&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>38&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>clearcut&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>39&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>40&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>41&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>42&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>43&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>44&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>45&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>46&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>47&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>48&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>49&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>50&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>51&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>52&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>53&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>54&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>55&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>56&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>57&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>58&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>59&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>60&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>61&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>62&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>63&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>64&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>65&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>66&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2019&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>67&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>68&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>69&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>70&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>71&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>72&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>73&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>74&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>75&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>76&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>77&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>78&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>79&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>80&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>81&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>82&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>83&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>84&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>85&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>86&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>87&emsp;<\/td><\/tr><tr><td>1<\/td><th>class&emsp;<\/th><td>other&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>3<\/td><th>year&emsp;<\/th><td>2020&emsp;<\/td><\/tr><tr><td>4<\/td><th>geom&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","clearcut","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":1,"opacity":0.9,"fillOpacity":0.84,"bringToFront":false,"sendToBack":false}]},{"method":"addHomeButton","args":[10.211062,51.849309,10.396786,51.944459,true,"train_areas_2019_2020 - class","Zoom to train_areas_2019_2020 - class","<strong> train_areas_2019_2020 - class <\/strong>","bottomright"]},{"method":"addLegend","args":[{"colors":["#4B0055","#FDE333"],"labels":["clearcut","other"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"train_areas_2019_2020 - class","extra":null,"layerId":null,"className":"info legend","group":"train_areas_2019_2020 - class"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAABfCAYAAAA075OVAAAEQUlEQVR4nO2dO3bkIBBF0Rzljhx5CT7eSW/I2SzKce+id+DexCQ9EX2wzKeqoOCB6kYeu4VoHvVRgZjt3/fnwznn3t6/3P12cf7nEv6ziFD6vxq7/4EqDLKAZ+bP6A4YbfglZM4tmTXqcr9dxGPMssgzxp4ReEE5ou7O8QQKkyJU7rfL1JNO0vft9eXjwb0IXciQmQXlYMnOIpAtciYrPHIGq0wKObNwOVYVNepaEUV8e/9qIgLid2uBxchF2NFmqLc6zX6Fba/iavfyR/oRG9RVBlobKNd6tEJtYVeaJNvry8cD1b3GaNFXqoCxe6GKD2WRhpzncySCVfZYeSndg1JLRrRKKItMDWCPSebvgTChJexoKwXH/mgP7GzCpeL2nvpjb2KTqXW/jvfgtj9iwlP2Ud1vFyzXasgZXhBIzTQEL+EcLwFrbbFh+7nxeLrWUcRioZb7krTLzaJT8V36nTihYKiQsRktsUTJdVKLL10XSx61E0qLkQux+Z3mKFBXP2piF8UaOVl0bJe+VvxM9QG+1ipZcsoNonSC1NRdpROH0xZUiS6kZgZLvws3gy71sfVzKmyyk0Mri+W4Pm5iE/67lYjUdizZWQRY1xrCtcrSw3PrNrRXZijtw7pWz4gdAVS3XiNgy0TJOYdTNI/BETE3+NqpPxeN4gDcLjqPZMYiLcel0OqjJTuLAB8jQ6gP5dzzEHLXp+4raVOTKYTkVlWOIrQQs4YeLn8K10p9WA/f8vXvitQM4gwx1zOFkEYZSNdKfeBOuU0US+I+h9b0G1JIJFrXTnNtxRI06soNnGuVlr9Qn4e55CZA7m/QFkkRR2PtUQtpDZgyDnAWaciA2+rhXN0zHPdajcJ4i83W1BDjPwfpWmviXYvddBoJjjbmWiNwjw9LFR5aTsjSJDEhleidRZuQiwCZ7JwdqpsOYzlksnNmqM/Bx6U6ExIIioihFYaftxi5CGaRQNSUFE1IcFKJz9ENT7FB2dPzkAgUqKW6qSwS7QSSXtjqx4mA3aB8ZmJveJVO5dp7nG/TAgSX2nKLpITcvac401zr7SdpP5DGxvOMkYidG0FpPyzqOFmyswjPQwUR3Ubv+F3aI4s0Nke28D8CjTGy87U7y6T3Sp1ghcyPgkC4LDK686UstaUHibU1+vtzsRi5CLA7BCSvnZ8ZSItEePifDUghzcL4wK5+5E6RSlksSgVoBJAWafCBtUjn6BZlMXVCi6SIxt3yr9WPnkBbZAhVQIR+jGA6i0zRwwKPIiKJuoyQZ2dKIWuOpS7BPZun9iyfVkwTI3OHv7cUkfI7RKYR0pM68ao1uWUtRKZ0rcZvTEgi6OW+6VyrJqn6ruaR2K0wIQ+0PB+uJ+ZaF8GEXAQTskCPAnwLLEYSKb1EMxqzSAaoIjpnQrJAqavGMCEXwWIkgdQ6JJKrNYsUgiSic85t1+v17+hOGPX8B+mSgxgEUBoKAAAAAElFTkSuQmCC",[[51.94444454499717,10.21166713945832],[51.84887689761319,10.39751161737801]],0.8,null,"harz_forest_mask","harz_forest_mask"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],["corine_harz - 1","train_areas_2019_2020 - class","harz_forest_mask"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addControl","args":["","topright","imageValues-harz_forest_mask","info legend "]},{"method":"addImageQuery","args":["harz_forest_mask",[10.21166713945832,51.8483989805471,10.39863583825444,51.94444454499717],"mousemove",7,"Layer"]},{"method":"addLegend","args":[{"colors":["#040404 , #040404 0%, #4E1E2F 20%, #9B2D59 40%, #D4637A 60%, #EDB28D 80%, #FFFE9E 100%, #FFFE9E "],"labels":["0.0","0.2","0.4","0.6","0.8","1.0"],"na_color":"#BEBEBE","na_label":"NA","opacity":1,"position":"topright","type":"numeric","title":"harz_forest_mask","extra":{"p_1":0,"p_n":1},"layerId":null,"className":"info legend","group":"harz_forest_mask"}]},{"method":"addHomeButton","args":[10.21166713945831,51.84964347643648,10.39735444628331,51.94440803302302,true,"harz_forest_mask","Zoom to harz_forest_mask","<strong> harz_forest_mask <\/strong>","bottomright"]},{"method":"addHomeButton","args":[10.211062,51.84887689761319,10.39751161737801,51.944459,true,null,"Zoom to full extent","<strong>Zoom full<\/strong>","bottomleft"]}],"limits":{"lat":[51.84887689761319,51.94444454499717],"lng":[10.21166713945832,10.39751161737801]},"fitBounds":[51.84887689761319,10.211062,51.944459,10.39751161737801,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create extents</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">ext</span>(harz_forest_mask)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">as.polygons</span>(e, <span class="at">crs=</span><span class="st">"EPSG:4326"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>cm<span class="ot">=</span>sf<span class="sc">::</span><span class="fu">st_as_sf</span>(p)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>harz_bbox <span class="ot">=</span> <span class="fu">bb</span>(train_areas_2019_2020,<span class="at">projection=</span><span class="dv">4326</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>harz_32632 <span class="ot">=</span>sf<span class="sc">::</span><span class="fu">st_transform</span>(train_areas_2019_2020,<span class="at">crs =</span> <span class="dv">32632</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>harz_bbox_32632 <span class="ot">=</span> <span class="fu">bb</span>(harz_32632,<span class="at">projection=</span><span class="dv">32632</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="step-1-retrieving-sentinel-data" class="level2">
<h2 class="anchored" data-anchor-id="step-1-retrieving-sentinel-data">Step 1: Retrieving Sentinel data</h2>
<section id="aternative-1-using-gdalcubes" class="level3">
<h3 class="anchored" data-anchor-id="aternative-1-using-gdalcubes">Aternative 1: Using <code>gdalcubes</code></h3>
<p>Sentinel-2 is currently the most important platform for Earth observation in all areas, but especially for climate change, land use and ecological issues at all levels, from the upper micro to the global scale.</p>
<p>There are two operational Sentinel-2 satellites: Sentinel-2A and Sentinel-2B, both in sun-synchronous polar orbits and 180 degrees out of phase. This arrangement allows them to cover the mid-latitudes with an orbital period of about 5 days.</p>
<p>The Sentinel-2 data are therefore predestined to record spatial and temporal changes on the Earth’s surface (the forest was green in early summer, it has disappeared by late summer). They are ideal for timely studies before and after natural disasters, or for biomass balancing, etc.</p>
<section id="cloud-optimised-geotiffs-cogs" class="level4">
<h4 class="anchored" data-anchor-id="cloud-optimised-geotiffs-cogs">Cloud-Optimised GeoTIFFs (COGs)</h4>
<p>Unfortunately, the official <a href="https://scihub.copernicus.eu/dhus/#/home">Sentinel-2 archives</a> are anything but user-friendly. Even with very convenient tools such as <a href="https://sen2r.ranghetti.info/"><code>sen2r</code></a> it is sometimes tedious to process them.Technically, the processed product levels are available for download pre-processed as L1C and L2A products in JP2K format. The preferred file format is JP2K, which is storage efficient but has to be downloaded in its entirety locally by the user, resulting in high access costs and huge local storage requirements. The cloud-optimised GeoTIFFs (COGs) allow only the areas of interest to be downloaded and are also much faster to process. However, this requires optimised cloud services and a technically different access logic than in the processing chains used so far.</p>
</section>
<section id="spatiotemporal-asset-catalog-stac" class="level4">
<h4 class="anchored" data-anchor-id="spatiotemporal-asset-catalog-stac">SpatioTemporal Asset Catalog (STAC)</h4>
<p>The [Spatial-Temporal Asset Catalogue] (https://stacspec.org/) (STAC) provides a common language for simplified indexing and discovery of geospatial data. A “Spatio-Temporal Asset” is a file that contains information in a specific space and time.</p>
<p>This approach allows any provider of spatio-temporal data (imagery, SAR, point clouds, data cubes, full motion video, etc.) to provide Spatio-Temporal Asset Catalogues (STAC) for their data. STAC focuses on an easy-to-implement standard that organisations can use to make their data available in a durable and reliable way.</p>
<p><a href="https://www.element84.com/">Element84</a> has provided a public API called Earth-search, a central search catalogue for all public AWS datasets using STAC (including the new Sentinel-2 COGs), which contains more than 11.4 million Sentinel-2 scenes worldwide as of 1 November 2017.</p>
<p>One major challenge is the fact that most of the earth surface related remote sensing activities are heavily <em>“disturbed”</em> by the atmosphere, especially by clouds. So to find cloud free satellite imagery is a common and cumbersome task. This task is supported by the <code>rstac</code> package which provides a convenient tool to find and filter adequate Sentinel-2 images out of the COG data storage. However, to address the AOI we need to provide the extend via the <code>bbox</code> argument of the corresponding function <code>stac_search()</code>. So first we need to derive and transform the required bounding box to WGS84 geo-coordinates, easily done with the <code>sf</code> functions <code>st_bbox()</code> and <code>st_transform()</code>. In addition we adapt the projection of the referencing vector objects to all other later projection needs.</p>
</section>
<section id="querying-images-with-rstac" class="level4">
<h4 class="anchored" data-anchor-id="querying-images-with-rstac">Querying images with <code>rstac</code></h4>
<p>Using the <code>rstac</code> package, we first request all available images from 2018 to 208 that intersect with our region of interest. Here, since the polygon has WGS84 as CRS, we do <strong>not</strong> need to transform the bounding box before using the <code>stac_search()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: fenced</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># search the data stack for the given period and area</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstac)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> <span class="fu">stac</span>(<span class="st">"https://earth-search.aws.element84.com/v0"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> s <span class="sc">|&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stac_search</span>(<span class="at">collections =</span> <span class="st">"sentinel-s2-l2a-cogs"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">bbox=</span> <span class="fu">as.vector</span>(harz_bbox), </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">datetime =</span> <span class="fu">c</span>(<span class="st">"2019-06-01/2021-09-01"</span>),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">limit =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">post_request</span>() </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>items</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>###Items
- matched feature(s): 334
- features (334 item(s) / 0 not fetched):
  - S2B_32UNC_20210901_0_L2A
  - S2B_32UNC_20210829_0_L2A
  - S2A_32UNC_20210827_0_L2A
  - S2A_32UNC_20210824_0_L2A
  - S2B_32UNC_20210822_0_L2A
  - S2B_32UNC_20210819_0_L2A
  - S2A_32UNC_20210817_0_L2A
  - S2A_32UNC_20210814_0_L2A
  - S2B_32UNC_20210812_0_L2A
  - S2B_32UNC_20210809_0_L2A
  - ... with 324 more feature(s).
- assets: 
AOT, B01, B02, B03, B04, B05, B06, B07, B08, B09, B11, B12, B8A, info, metadata, overview, SCL, thumbnail, visual, WVP
- item's fields: 
assets, bbox, collection, geometry, id, links, properties, properties.sentinel:boa_offset_applied, stac_extensions, stac_version, type</code></pre>
</div>
</div>
<p>This gives us 350 matching images recorded between Januar 2019 and December 2023.</p>
</section>
<section id="creating-a-monthly-sentinel-2-data-cube" class="level4">
<h4 class="anchored" data-anchor-id="creating-a-monthly-sentinel-2-data-cube">Creating a monthly Sentinel-2 data cube</h4>
<p>To obtain a Sentinel data cube, a gdalcube image collection must be created from the STAC query result. To do this, the asset names must be explicitly named in order to apply the SCL channel with the quality characteristics per pixel (classification as clouds, cloud shadows, etc.). In this query, a filter is set to cloud cover &lt;= 50%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gdalcubes)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>s2_collection <span class="ot">&lt;-</span> <span class="fu">stac_image_collection</span>(items<span class="sc">$</span>features,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">asset_names =</span> <span class="fu">c</span>(<span class="st">"B04"</span>,<span class="st">"B08"</span>,<span class="st">"SCL"</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#c("B01","B02","B03","B04","B05","B06", "B07","B08","B8A","B09","B11","SCL"), </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">property_filter =</span> <span class="cf">function</span>(x) {x[[<span class="st">"eo:cloud_cover"</span>]] <span class="sc">&lt;</span> <span class="dv">5</span>}) </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>s2_collection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Image collection object, referencing 42 images with 3 bands
Images:
                      name     left      top   bottom    right
1 S2A_32UNC_20210718_0_L2A 8.999721 52.35046 51.35264 10.61137
2 S2B_32UNC_20210630_0_L2A 9.473193 52.34714 51.35264 10.61137
3 S2B_32UNC_20210531_1_L2A 9.468597 52.34718 51.35264 10.61137
4 S2A_32UNC_20210516_1_L2A 9.479513 52.34710 51.35264 10.61137
5 S2B_32UNC_20210514_0_L2A 8.999721 52.35046 51.35266 10.60492
6 S2B_32UNC_20210511_0_L2A 9.475491 52.34712 51.35264 10.61137
             datetime        srs
1 2021-07-18T10:36:33 EPSG:32632
2 2021-06-30T10:26:33 EPSG:32632
3 2021-05-31T10:26:33 EPSG:32632
4 2021-05-16T10:26:32 EPSG:32632
5 2021-05-14T10:36:29 EPSG:32632
6 2021-05-11T10:26:30 EPSG:32632
[ omitted 36 images ] 

Bands:
  name offset scale unit nodata image_count
1  B04      0     1                      42
2  B08      0     1                      42
3  SCL      0     1                      42</code></pre>
</div>
</div>
<p>The result is 118 images, i.e.&nbsp;approx. 1.8 images per month, from which we can now create a data cube. To do this, we use the UTM bounding box of our polygon as a spatial boundary, a spatial resolution of 10 metres, a bilinear spatial interpolation (useful for the spatially lower-resolution sentinel channels) and calculate monthly median values for all pixel values from the available images of a month. In addition, we add a buffer (b) on each side of the cube.</p>
<p>The <em>gdalcube image collection</em> can be considered as a proxy structure object which will be applied on the COGs.</p>
<div class="cell" data-messages="false" data-warnings="false">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>v <span class="ot">=</span> <span class="fu">cube_view</span>(<span class="at">srs =</span> <span class="st">"EPSG:32632"</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">dx =</span> <span class="dv">10</span>, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">dy =</span> <span class="dv">10</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">dt =</span> <span class="st">"P1M"</span>,  </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">aggregation =</span> <span class="st">"median"</span>, </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">extent =</span> <span class="fu">list</span>(<span class="at">t0 =</span> <span class="st">"2019-06-01"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">t1 =</span> <span class="st">"2021-09-01"</span>, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">left =</span> <span class="fu">st_bbox</span>(harz_32632)[<span class="st">"xmin"</span>] , </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">right =</span> <span class="fu">st_bbox</span>(harz_32632)[<span class="st">"xmax"</span>] ,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">bottom =</span> <span class="fu">st_bbox</span>(harz_32632)[<span class="st">"ymin"</span>] , </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">top =</span> <span class="fu">st_bbox</span>(harz_32632)[<span class="st">"ymax"</span>] ),</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">resampling =</span> <span class="st">"bilinear"</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A data cube view object

Dimensions:
               low             high count pixel_size
t       2019-06-01       2021-09-30    28        P1M
y 5744990.36803304 5755740.36803304  1075         10
x 583320.314607046 596010.314607046  1269         10

SRS: "EPSG:32632"
Temporal aggregation method: "median"
Spatial resampling method: "bilinear"</code></pre>
</div>
</div>
<p>Next we create a data cube, subset the red and near infrared bands and crop by our polygon, which simply sets pixel values outside the polygon to NA. We then save the data cube as a single netCDF file. Note that this is not necessary, but saving intermediate results sometimes makes debugging easier, especially if the methods applied afterwards are computationally intensive.</p>
<p>Only calling a final <em>action</em> will start the processing on the COG-Server. In this case ‘write_ncdf’.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ##</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we "download" the data and write it t a netcdf file</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  s2.mask <span class="ot">=</span> <span class="fu">image_mask</span>(<span class="st">"SCL"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">9</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gdalcubes_options</span>(<span class="at">parallel =</span> <span class="dv">16</span>, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncdf_compression_level =</span> <span class="dv">5</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">raster_cube</span>(s2_collection, v, <span class="at">mask =</span> s2.mask) <span class="sc">|&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write_ncdf</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/harz_2019_2021_kndvi.nc"</span>),<span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="kndvi" class="level4">
<h4 class="anchored" data-anchor-id="kndvi">kNDVI</h4>
<p>Below, we derive mean monthly <a href="https://advances.sciencemag.org/content/7/9/eabc7447">kNDVI</a> values over all pixel time series.</p>
<div class="cell" data-messages="false" data-warnings="false">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ncdf_cube</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/harz_2019_2021_kndvi.nc"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">apply_pixel</span>(<span class="st">"tanh(((B08-B04)/(B08+B04))^2)"</span>, <span class="st">"kNDVI"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_time</span>(<span class="st">"mean(kNDVI)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">key.pos =</span> <span class="dv">1</span>,  <span class="at">col =</span> ndvi.col, <span class="at">nbreaks =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/forest_kndvi-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="alternative-2-copernicus-data-space-ecosystem-api-wrapper-cdse" class="level3">
<h3 class="anchored" data-anchor-id="alternative-2-copernicus-data-space-ecosystem-api-wrapper-cdse">Alternative 2: Copernicus Data Space Ecosystem API Wrapper CDSE</h3>
<p>The <a href="https://zivankaraman.github.io/CDSE/articles/CDSE.html">CDSE package</a> provides another simple way to get Sentinel/Copernicus data sets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#------------</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: You must create an Copernicus account and provide the token credtials have a look at:</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#       https://zivankaraman.github.io/CDSE/articles/BeforeYouStart.html#accessing-cdse-data-and-services</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"CDSE_ID"</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>secret <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"CDSE_SECRET"</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>OAuthClient <span class="ot">&lt;-</span> <span class="fu">GetOAuthClient</span>(<span class="at">id =</span> id, <span class="at">secret =</span> secret)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>collections <span class="ot">&lt;-</span> <span class="fu">GetCollections</span>(<span class="at">as_data_frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>collections</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  id                title
1     sentinel-2-l1c       Sentinel 2 L1C
2 sentinel-3-olci-l2   Sentinel 3 OLCI L2
3    sentinel-3-olci      Sentinel 3 OLCI
4   sentinel-3-slstr     Sentinel 3 SLSTR
5     sentinel-1-grd       Sentinel 1 GRD
6     sentinel-2-l2a       Sentinel 2 L2A
7     sentinel-5p-l2 Sentinel 5 Precursor
                                                   description
1                     Sentinel 2 imagery processed to level 1C
2 Sentinel 3 data derived from imagery captured by OLCI sensor
3                   Sentinel 3 imagery captured by OLCI sensor
4                  Sentinel 3 imagery captured by SLSTR sensor
5                     Sentinel 1 Ground Range Detected Imagery
6                     Sentinel 2 imagery processed to level 2A
7      Sentinel 5 Precursor imagery captured by TROPOMI sensor
                 since instrument  gsd bands constellation long.min lat.min
1 2015-11-01T00:00:00Z        msi   10    13    sentinel-2     -180     -56
2 2016-04-17T11:33:13Z       olci  300    NA          &lt;NA&gt;     -180     -85
3 2016-04-17T11:33:13Z       olci  300    21          &lt;NA&gt;     -180     -85
4 2016-04-17T11:33:13Z      slstr 1000    11          &lt;NA&gt;     -180     -85
5 2014-10-03T00:00:00Z      c-sar   NA    NA    sentinel-1     -180     -85
6 2016-11-01T00:00:00Z        msi   10    12    sentinel-2     -180     -56
7 2018-04-30T00:18:50Z    tropomi 5500    NA          &lt;NA&gt;     -180     -85
  long.max lat.max
1      180      83
2      180      85
3      180      85
4      180      85
5      180      85
6      180      83
7      180      85</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>images <span class="ot">&lt;-</span> <span class="fu">SearchCatalog</span>(<span class="at">bbox =</span> <span class="fu">st_bbox</span>(train_areas_2019_2020), <span class="at">from =</span> <span class="st">"2018-05-01"</span>, <span class="at">to =</span> <span class="st">"2022-12-31"</span>, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">collection =</span> <span class="st">"sentinel-2-l2a"</span>, <span class="at">with_geometry =</span> <span class="cn">TRUE</span>, <span class="at">client =</span> OAuthClient)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>although coordinates are longitude/latitude, st_intersects assumes that they
are planar</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>although coordinates are longitude/latitude, st_intersection assumes that they
are planar</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>images</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 688 features and 11 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 8.999721 ymin: 51.35264 xmax: 10.61137 ymax: 52.35046
Geodetic CRS:  WGS 84
First 10 features:
   acquisitionDate tileCloudCover areaCoverage   satellite
1       2022-12-30         100.00          100 sentinel-2a
2       2022-12-27          79.15          100 sentinel-2a
3       2022-12-25          99.99          100 sentinel-2b
4       2022-12-22          99.45          100 sentinel-2b
5       2022-12-20          97.60          100 sentinel-2a
6       2022-12-17          29.56          100 sentinel-2a
7       2022-12-15           3.80          100 sentinel-2b
8       2022-12-10          95.63          100 sentinel-2a
9       2022-12-07          96.07          100 sentinel-2a
10      2022-12-05          99.99          100 sentinel-2b
   acquisitionTimestampUTC acquisitionTimestampLocal
1      2022-12-30 10:36:29       2022-12-30 11:36:29
2      2022-12-27 10:26:31       2022-12-27 11:26:31
3      2022-12-25 10:36:29       2022-12-25 11:36:29
4      2022-12-22 10:26:31       2022-12-22 11:26:31
5      2022-12-20 10:36:28       2022-12-20 11:36:28
6      2022-12-17 10:26:31       2022-12-17 11:26:31
7      2022-12-15 10:36:28       2022-12-15 11:36:28
8      2022-12-10 10:36:30       2022-12-10 11:36:30
9      2022-12-07 10:26:33       2022-12-07 11:26:33
10     2022-12-05 10:36:27       2022-12-05 11:36:27
                                                            sourceId long.min
1  S2A_MSIL2A_20221230T103431_N0509_R108_T32UNC_20221230T134707.SAFE 8.999721
2  S2A_MSIL2A_20221227T102431_N0509_R065_T32UNC_20221227T140052.SAFE 9.476927
3  S2B_MSIL2A_20221225T103349_N0509_R108_T32UNC_20221225T114808.SAFE 8.999721
4  S2B_MSIL2A_20221222T102339_N0509_R065_T32UNC_20221222T113435.SAFE 9.485113
5  S2A_MSIL2A_20221220T103441_N0509_R108_T32UNC_20221220T134756.SAFE 8.999721
6  S2A_MSIL2A_20221217T102431_N0509_R065_T32UNC_20221217T141955.SAFE 9.478651
7  S2B_MSIL2A_20221215T103339_N0509_R108_T32UNC_20221215T114317.SAFE 8.999721
8  S2A_MSIL2A_20221210T103431_N0509_R108_T32UNC_20221210T142357.SAFE 8.999721
9  S2A_MSIL2A_20221207T102411_N0509_R065_T32UNC_20221207T135807.SAFE 9.476926
10 S2B_MSIL2A_20221205T103319_N0400_R108_T32UNC_20221205T113923.SAFE 8.999721
    lat.min long.max  lat.max                       geometry
1  51.35264 10.61137 52.35046 POLYGON ((8.999721 52.35046...
2  51.35264 10.61137 52.34711 POLYGON ((9.889693 52.34711...
3  51.35264 10.61137 52.35046 POLYGON ((8.999721 52.35046...
4  51.35264 10.61137 52.34705 POLYGON ((9.898795 52.34705...
5  51.35264 10.61137 52.35046 POLYGON ((8.999721 52.35046...
6  51.35264 10.61137 52.34710 POLYGON ((9.891455 52.3471,...
7  51.35264 10.61137 52.35046 POLYGON ((8.999721 52.35046...
8  51.35264 10.61137 52.35046 POLYGON ((8.999721 52.35046...
9  51.35264 10.61137 52.34711 POLYGON ((9.890282 52.34711...
10 51.35264 10.61137 52.35046 POLYGON ((8.999721 52.35046...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(images<span class="sc">$</span>areaCoverage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  15.48  100.00  100.00   99.83  100.00  100.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best 30 days without clouds</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>day <span class="ot">&lt;-</span> images[<span class="fu">order</span>(images<span class="sc">$</span>tileCloudCover), ]<span class="sc">$</span>acquisitionDate[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># read specific processing scripts</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>script_file_raw <span class="ot">=</span> <span class="fu">system.file</span>(<span class="st">"scripts"</span>, <span class="st">"RawBands.js"</span>, <span class="at">package =</span> <span class="st">"CDSE"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>script_file_savi <span class="ot">=</span> <span class="st">"savi.js"</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>script_file_kndvi <span class="ot">=</span> <span class="st">"kndvi.js"</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>script_file_evi <span class="ot">=</span> <span class="st">"evi.js"</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># first day 2018_07_01</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>raw_2018_07_01 <span class="ot">=</span> <span class="fu">GetImage</span>(<span class="at">bbox =</span> <span class="fu">st_bbox</span>(train_areas_2019_2020), </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">time_range =</span> day[<span class="dv">12</span>], </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">script =</span> script_file_raw, </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">collection =</span> <span class="st">"sentinel-2-l2a"</span>, </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">format =</span> <span class="st">"image/tiff"</span>, </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mosaicking_order =</span> <span class="st">"leastCC"</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">resolution =</span> <span class="dv">10</span>, </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mask =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">buffer =</span> <span class="fl">0.01</span>, </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">client =</span> OAuthClient)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_buffer.sfc(bounds, dist = buffer, joinStyle = "MITRE", mitreLimit
= 999999): st_buffer does not correctly buffer longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>dist is assumed to be in decimal degrees (arc_degrees).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_centroid.sfc(bounds): st_centroid does not give correct centroids
for longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: /tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(raw_2018_07_01) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"B01"</span>, <span class="st">"B02"</span>, <span class="st">"B03"</span>, <span class="st">"B04"</span>, <span class="st">"B05"</span>, <span class="st">"B06"</span>, <span class="st">"B07"</span>, <span class="st">"B08"</span>, <span class="st">"B8A"</span>, <span class="st">"B09"</span>, <span class="st">"B11"</span>, <span class="st">"B12"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(raw_2018_07_01, <span class="at">main =</span> <span class="fu">paste</span>(<span class="fu">names</span>(raw_2018_07_01), day[<span class="dv">12</span>]), <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/cdse-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>kndvi_2018_07_01 <span class="ot">&lt;-</span> <span class="fu">GetImage</span>(<span class="at">bbox =</span> <span class="fu">st_bbox</span>(train_areas_2019_2020),</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">time_range =</span> day[<span class="dv">12</span>], </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">script =</span> script_file_kndvi, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">collection =</span> <span class="st">"sentinel-2-l2a"</span>, </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">format =</span> <span class="st">"image/tiff"</span>, </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mosaicking_order =</span> <span class="st">"leastCC"</span>, </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">resolution =</span> <span class="dv">10</span>, </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mask =</span> <span class="cn">TRUE</span>, </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">buffer =</span> <span class="fl">0.01</span>, </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">client =</span> OAuthClient)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_buffer.sfc(bounds, dist = buffer, joinStyle = "MITRE", mitreLimit
= 999999): st_buffer does not correctly buffer longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>dist is assumed to be in decimal degrees (arc_degrees).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_centroid.sfc(bounds): st_centroid does not give correct centroids
for longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in readLines(script): unvollständige letzte Zeile in 'kndvi.js'
gefunden</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: /tmp/Rtmpt2vxPR/file68067619224b6: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(kndvi_2018_07_01 )[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"kNDVI"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(kndvi_2018_07_01[[<span class="dv">1</span>]] , <span class="at">main =</span> <span class="fu">paste</span>(<span class="fu">names</span>(kndvi_2018_07_01 ), day[<span class="dv">12</span>]), <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067619224b6: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/cdse-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>savi_2018_07_01 <span class="ot">&lt;-</span> <span class="fu">GetImage</span>(<span class="at">bbox =</span> <span class="fu">st_bbox</span>(train_areas_2019_2020), </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">time_range =</span> day[<span class="dv">12</span>], </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">script =</span> script_file_savi, </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">collection =</span> <span class="st">"sentinel-2-l2a"</span>, </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">format =</span> <span class="st">"image/tiff"</span>, </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mosaicking_order =</span> <span class="st">"leastCC"</span>, </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">resolution =</span> <span class="dv">10</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mask =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">buffer =</span> <span class="fl">0.01</span>, </span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">client =</span> OAuthClient)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_buffer.sfc(bounds, dist = buffer, joinStyle = "MITRE", mitreLimit
= 999999): st_buffer does not correctly buffer longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>dist is assumed to be in decimal degrees (arc_degrees).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_centroid.sfc(bounds): st_centroid does not give correct centroids
for longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in readLines(script): unvollständige letzte Zeile in 'savi.js' gefunden</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: /tmp/Rtmpt2vxPR/file6806765b5a86b: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(savi_2018_07_01)[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">c</span>( <span class="st">"SAVI"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(savi_2018_07_01[[<span class="dv">1</span>]], <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"SAVI"</span>, day[<span class="dv">12</span>]), <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806765b5a86b: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/cdse-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>evi_2018_07_01 <span class="ot">&lt;-</span> <span class="fu">GetImage</span>(<span class="at">bbox =</span> <span class="fu">st_bbox</span>(train_areas_2019_2020), </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">time_range =</span> day[<span class="dv">12</span>], </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">script =</span> script_file_evi, </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">collection =</span> <span class="st">"sentinel-2-l2a"</span>, </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">format =</span> <span class="st">"image/tiff"</span>, </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mosaicking_order =</span> <span class="st">"leastCC"</span>, </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">resolution =</span> <span class="dv">10</span>, </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mask =</span> <span class="cn">TRUE</span>, </span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">buffer =</span> <span class="fl">0.01</span>, </span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">client =</span> OAuthClient)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_buffer.sfc(bounds, dist = buffer, joinStyle = "MITRE", mitreLimit
= 999999): st_buffer does not correctly buffer longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>dist is assumed to be in decimal degrees (arc_degrees).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_centroid.sfc(bounds): st_centroid does not give correct centroids
for longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in readLines(script): unvollständige letzte Zeile in 'evi.js' gefunden</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: /tmp/Rtmpt2vxPR/file6806727840b84: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(evi_2018_07_01)[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">c</span>( <span class="st">"EVI"</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(evi_2018_07_01[[<span class="dv">1</span>]], <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"EVI"</span>,day[<span class="dv">12</span>]), <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806727840b84: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/cdse-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>pred_stack_2018 <span class="ot">=</span> <span class="fu">c</span>(raw_2018_07_01,evi_2018_07_01[[<span class="dv">1</span>]],kndvi_2018_07_01[[<span class="dv">1</span>]],savi_2018_07_01[[<span class="dv">1</span>]])</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="do">## second day 2022_06_23</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>raw_2022_06_23 <span class="ot">=</span> <span class="fu">GetImage</span>(<span class="at">bbox =</span> <span class="fu">st_bbox</span>(train_areas_2019_2020), </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">time_range =</span> day[<span class="dv">1</span>], </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">script =</span> script_file_raw, </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">collection =</span> <span class="st">"sentinel-2-l2a"</span>, </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">format =</span> <span class="st">"image/tiff"</span>, </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mosaicking_order =</span> <span class="st">"leastCC"</span>, </span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">resolution =</span> <span class="dv">10</span>, </span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mask =</span> <span class="cn">TRUE</span>, </span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">buffer =</span> <span class="fl">0.01</span>, </span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">client =</span> OAuthClient)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_buffer.sfc(bounds, dist = buffer, joinStyle = "MITRE", mitreLimit
= 999999): st_buffer does not correctly buffer longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>dist is assumed to be in decimal degrees (arc_degrees).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_centroid.sfc(bounds): st_centroid does not give correct centroids
for longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: /tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(raw_2022_06_23) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"B01"</span>, <span class="st">"B02"</span>, <span class="st">"B03"</span>, <span class="st">"B04"</span>, <span class="st">"B05"</span>, <span class="st">"B06"</span>, <span class="st">"B07"</span>, <span class="st">"B08"</span>, <span class="st">"B8A"</span>, <span class="st">"B09"</span>, <span class="st">"B11"</span>, <span class="st">"B12"</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(raw_2022_06_23, <span class="at">main =</span> <span class="fu">paste</span>(<span class="fu">names</span>(raw_2022_06_23), day[<span class="dv">1</span>]), <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/cdse-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>kndvi_2022_06_23 <span class="ot">&lt;-</span> <span class="fu">GetImage</span>(<span class="at">bbox =</span> <span class="fu">st_bbox</span>(train_areas_2019_2020), </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">time_range =</span> day[<span class="dv">1</span>], </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">script =</span> script_file_kndvi, </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">collection =</span> <span class="st">"sentinel-2-l2a"</span>, </span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">format =</span> <span class="st">"image/tiff"</span>,</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mosaicking_order =</span> <span class="st">"leastCC"</span>, </span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">resolution =</span> <span class="dv">10</span>, </span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mask =</span> <span class="cn">TRUE</span>, </span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">buffer =</span> <span class="fl">0.01</span>, </span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">client =</span> OAuthClient)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_buffer.sfc(bounds, dist = buffer, joinStyle = "MITRE", mitreLimit
= 999999): st_buffer does not correctly buffer longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>dist is assumed to be in decimal degrees (arc_degrees).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_centroid.sfc(bounds): st_centroid does not give correct centroids
for longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in readLines(script): unvollständige letzte Zeile in 'kndvi.js'
gefunden</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: /tmp/Rtmpt2vxPR/file6806756306a2a: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(kndvi_2022_06_23)[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"kNDVI"</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(kndvi_2022_06_23[[<span class="dv">1</span>]] , <span class="at">main =</span> <span class="fu">paste</span>(<span class="fu">names</span>(kndvi_2022_06_23 ), day[<span class="dv">1</span>]), <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806756306a2a: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/cdse-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>savi_2022_06_23 <span class="ot">&lt;-</span> <span class="fu">GetImage</span>(<span class="at">bbox =</span> <span class="fu">st_bbox</span>(train_areas_2019_2020), </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">time_range =</span> day[<span class="dv">1</span>], </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">script =</span> script_file_savi, </span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">collection =</span> <span class="st">"sentinel-2-l2a"</span>, </span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">format =</span> <span class="st">"image/tiff"</span>, </span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mosaicking_order =</span> <span class="st">"leastCC"</span>, </span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">resolution =</span> <span class="dv">10</span>,</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mask =</span> <span class="cn">TRUE</span>, </span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">buffer =</span> <span class="fl">0.01</span>, </span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">client =</span> OAuthClient)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_buffer.sfc(bounds, dist = buffer, joinStyle = "MITRE", mitreLimit
= 999999): st_buffer does not correctly buffer longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>dist is assumed to be in decimal degrees (arc_degrees).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_centroid.sfc(bounds): st_centroid does not give correct centroids
for longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in readLines(script): unvollständige letzte Zeile in 'savi.js' gefunden</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: /tmp/Rtmpt2vxPR/file6806739e627f4: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(savi_2022_06_23)[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">c</span>( <span class="st">"SAVI"</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(savi_2022_06_23[[<span class="dv">1</span>]], <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"SAVI"</span>,day[<span class="dv">1</span>]), <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806739e627f4: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/cdse-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>evi_2022_06_23 <span class="ot">&lt;-</span> <span class="fu">GetImage</span>(<span class="at">bbox =</span> <span class="fu">st_bbox</span>(train_areas_2019_2020), </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">time_range =</span> day[<span class="dv">1</span>], </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">script =</span> script_file_evi, </span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">collection =</span> <span class="st">"sentinel-2-l2a"</span>, </span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">format =</span> <span class="st">"image/tiff"</span>,</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mosaicking_order =</span> <span class="st">"leastCC"</span>,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">resolution =</span> <span class="dv">10</span>, </span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mask =</span> <span class="cn">TRUE</span>, </span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">buffer =</span> <span class="fl">0.01</span>, </span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">client =</span> OAuthClient)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_buffer.sfc(bounds, dist = buffer, joinStyle = "MITRE", mitreLimit
= 999999): st_buffer does not correctly buffer longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>dist is assumed to be in decimal degrees (arc_degrees).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_centroid.sfc(bounds): st_centroid does not give correct centroids
for longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in readLines(script): unvollständige letzte Zeile in 'evi.js' gefunden</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: /tmp/Rtmpt2vxPR/file680674ed52d7d: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in new_CppObject_xp(fields$.module, fields$.pointer, ...): GDAL Message
1: TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(evi_2022_06_23)[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">c</span>( <span class="st">"EVI"</span>)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(evi_2022_06_23[[<span class="dv">1</span>]], <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"EVI"</span>,day[<span class="dv">1</span>]), <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680674ed52d7d: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$sampleRegularRaster(size): GDAL Message 1:
TIFFReadDirectory:Sum of Photometric type-related color channels and
ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as
ExtraSamples.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/cdse-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>pred_stack_2022 <span class="ot">=</span> <span class="fu">c</span>(raw_2022_06_23,evi_2022_06_23[[<span class="dv">1</span>]],kndvi_2022_06_23[[<span class="dv">1</span>]],savi_2022_06_23[[<span class="dv">1</span>]])</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">writeRaster</span>(pred_stack_2018,<span class="fu">file.path</span>(root_folder,<span class="st">"data/pred_stack_2018.tif"</span>),<span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$writeRaster(opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$writeRaster(opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806727840b84: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$writeRaster(opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067619224b6: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$writeRaster(opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806765b5a86b: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">writeRaster</span>(pred_stack_2022,<span class="fu">file.path</span>(root_folder,<span class="st">"data/pred_stack_2022.tif"</span>),<span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$writeRaster(opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$writeRaster(opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680674ed52d7d: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$writeRaster(opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806756306a2a: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$writeRaster(opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806739e627f4: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
</div>
</section>
</section>
<section id="step2-overview-unsupervised-classification" class="level2">
<h2 class="anchored" data-anchor-id="step2-overview-unsupervised-classification">Step2: Overview – Unsupervised classification</h2>
<section id="k-means-clustering" class="level3">
<h3 class="anchored" data-anchor-id="k-means-clustering">k-means clustering</h3>
<p>In our example (applied to 5 classes and executed with the function <code>unsuperClass</code> from the <code>RStoolbox</code> package), this looks as follows. The cluster algorithm can achieve a fairly acceptable separation of the clearings/bald spots with 5 clusters, which makes a classification seem promising. Also experiment with other cluster settings and discuss the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="do">## k-means über RStoolbox</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co">#"EVI"   "kNDVI" "SAVI"</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>prediction_kmeans_2018 <span class="ot">=</span> RStoolbox<span class="sc">::</span><span class="fu">unsuperClass</span>(pred_stack_2018, </span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">nClasses =</span> <span class="dv">5</span>,</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">norm =</span> <span class="cn">TRUE</span>, </span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">algorithm =</span> <span class="st">"MacQueen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806727840b84: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067619224b6: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806765b5a86b: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067168e0cef: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806727840b84: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file68067619224b6: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806765b5a86b: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Klassifikation</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prediction_kmeans_2018<span class="sc">$</span>map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/kmenas-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>prediction_kmeans_2022 <span class="ot">=</span> RStoolbox<span class="sc">::</span><span class="fu">unsuperClass</span>(pred_stack_2022, </span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">nClasses =</span> <span class="dv">5</span>,<span class="at">norm =</span> <span class="cn">TRUE</span>, </span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">algorithm =</span> <span class="st">"MacQueen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680674ed52d7d: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806756306a2a: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806739e627f4: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680677316d2af: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file680674ed52d7d: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806756306a2a: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in x@ptr$scale(center, docenter, scale, doscale, opt): GDAL Message 1:
/tmp/Rtmpt2vxPR/file6806739e627f4: TIFFReadDirectory:Sum of Photometric
type-related color channels and ExtraSamples doesn't match SamplesPerPixel.
Defining non-color channels as ExtraSamples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prediction_kmeans_2022<span class="sc">$</span>map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/kmenas-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><img src="images/kmeans-2018.png" class="img-fluid"> <img src="images/kmeans-2022.png" class="img-fluid"></p>
</section>
<section id="bfast-spatial-identification-of-magnitudes-and-time-periods-of-kndvi-changes" class="level3">
<h3 class="anchored" data-anchor-id="bfast-spatial-identification-of-magnitudes-and-time-periods-of-kndvi-changes">bfast: Spatial identification of magnitudes and time periods of kNDVI changes</h3>
<p>To apply a more complex time series method such as <em>Breaks For Additive Seasonal and Trend</em> (BFAST), which is often used for land cover changes (e.g. <span class="citation" data-cites="bfast_rs2020">(<a href="#ref-bfast_rs2020" role="doc-biblioref">Wu et al. 2020</a>)</span>), the <code>bfastmonitor()</code> function in <code>gdalcubes</code> can be used, the data cube operations below allow you to provide custom user-defined R functions instead of string expressions that translate to built-in reducers.</p>
<p>In our example, <code>bfastmonitor</code> returns <em>change date</em> and <em>change magnitude</em> values per time series so we can use <code>reduce_time()</code>. The script below: 1. calculates the <a href="https://advances.sciencemag.org/content/7/9/eabc7447">kNDVI</a>, 1. applies <code>bfastmonitor()</code>, and properly handles errors e.g.&nbsp;due to missing data with <code>tryCatch()</code>, and 1. finally writes out the resulting change dates and magnitudes of change for all pixels of the time series as a netCDF file.</p>
<p>The results shows the changes starting at 7/2019 until 10/2021.</p>
<div class="cell" data-messages="false" data-warnings="false">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>figtrim <span class="ot">&lt;-</span> <span class="cf">function</span>(path) {</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>  img <span class="ot">&lt;-</span> magick<span class="sc">::</span><span class="fu">image_trim</span>(magick<span class="sc">::</span><span class="fu">image_read</span>(path))</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>  magick<span class="sc">::</span><span class="fu">image_write</span>(img, path)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>  path</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="fu">gdalcubes_options</span>(<span class="at">parallel =</span> <span class="dv">12</span>)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a><span class="do">## start analysis</span></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ncdf_cube</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/harz_2019_2021_kndvi.nc"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reduce_time</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"change_date"</span>, <span class="st">"change_magnitude"</span>, <span class="st">"kndvi"</span>), </span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>                  kndvi <span class="ot">=</span> <span class="fu">tanh</span>(((x[<span class="st">'B08'</span>,]<span class="sc">-</span>x[<span class="st">'B04'</span>,])<span class="sc">/</span>(x[<span class="st">'B08'</span>,]<span class="sc">+</span>x[<span class="st">'B04'</span>,]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">is.na</span>(kndvi))) {</span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">return</span>(<span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>))</span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>                  kndvi_ts <span class="ot">=</span> <span class="fu">ts</span>(kndvi, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2019</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">library</span>(bfast)</span>
<span id="cb175-20"><a href="#cb175-20" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">tryCatch</span>({</span>
<span id="cb175-21"><a href="#cb175-21" aria-hidden="true" tabindex="-1"></a>                    result <span class="ot">=</span> <span class="fu">bfastmonitor</span>(kndvi_ts, </span>
<span id="cb175-22"><a href="#cb175-22" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2020</span>,<span class="dv">1</span>), </span>
<span id="cb175-23"><a href="#cb175-23" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">history =</span> <span class="st">"all"</span>, </span>
<span id="cb175-24"><a href="#cb175-24" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">level =</span> <span class="fl">0.01</span>)</span>
<span id="cb175-25"><a href="#cb175-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">return</span>(<span class="fu">c</span>(result<span class="sc">$</span>breakpoint, result<span class="sc">$</span>magnitude))</span>
<span id="cb175-26"><a href="#cb175-26" aria-hidden="true" tabindex="-1"></a>                    }, <span class="at">error =</span> <span class="cf">function</span>(x) {<span class="fu">return</span>(<span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>))</span>
<span id="cb175-27"><a href="#cb175-27" aria-hidden="true" tabindex="-1"></a>                      })</span>
<span id="cb175-28"><a href="#cb175-28" aria-hidden="true" tabindex="-1"></a>                  }) <span class="sc">|&gt;</span></span>
<span id="cb175-29"><a href="#cb175-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write_ncdf</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/bfast_results.nc"</span>),<span class="at">overwrite =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can use the netCDF file and map the results with any preferred visualisation tool. In this case <code>tmap</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting it from the local ncdf  </span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>gdalcubes<span class="sc">::</span><span class="fu">ncdf_cube</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/bfast_results.nc"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  stars<span class="sc">::</span><span class="fu">st_as_stars</span>() <span class="ot">-&gt;</span> x</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(osm_forest) <span class="sc">+</span> <span class="fu">tm_rgb</span>() <span class="sc">+</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(x[<span class="dv">1</span>]) <span class="sc">+</span> </span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n =</span> <span class="dv">6</span>)  <span class="sc">+</span></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.show =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.label.height=</span><span class="fl">0.6</span>,</span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.label.size=</span><span class="fl">0.6</span>,</span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.size =</span> <span class="fl">0.4</span>,</span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>()</span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(osm_forest) <span class="sc">+</span> <span class="fu">tm_rgb</span>() <span class="sc">+</span></span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(x[<span class="dv">2</span>])  <span class="sc">+</span> <span class="fu">tm_raster</span>() <span class="sc">+</span></span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.label.height=</span><span class="fl">0.6</span>,</span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.label.size=</span><span class="fl">0.6</span>,</span>
<span id="cb176-22"><a href="#cb176-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.4</span>,</span>
<span id="cb176-23"><a href="#cb176-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb176-24"><a href="#cb176-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting it from the local ncdf  </span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Period of Change Map</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>gdalcubes<span class="sc">::</span><span class="fu">ncdf_cube</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/bfast_results.nc"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>  stars<span class="sc">::</span><span class="fu">st_as_stars</span>() <span class="ot">-&gt;</span> x</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tmap_save</span>(<span class="fu">tm_shape</span>(osm_forest) <span class="sc">+</span> <span class="fu">tm_rgb</span>() <span class="sc">+</span></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(x[<span class="dv">1</span>] ) <span class="sc">+</span> </span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n =</span> <span class="dv">6</span>)  <span class="sc">+</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.show =</span> <span class="cn">TRUE</span>,</span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.label.height=</span><span class="fl">0.6</span>,</span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.label.size=</span><span class="fl">0.6</span>,</span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.size =</span> <span class="fl">0.4</span>,</span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(), <span class="at">file =</span> <span class="st">"m1.html"</span> ) </span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Magnitude Change Map </span></span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tmap_save</span>(<span class="fu">tm_shape</span>(osm_forest) <span class="sc">+</span> <span class="fu">tm_rgb</span>() <span class="sc">+</span></span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(x[<span class="dv">2</span>])  <span class="sc">+</span> <span class="fu">tm_raster</span>() <span class="sc">+</span></span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.show =</span> <span class="cn">TRUE</span>,</span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.label.height=</span><span class="fl">0.6</span>,</span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.label.size=</span><span class="fl">0.6</span>,</span>
<span id="cb177-26"><a href="#cb177-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.size =</span> <span class="fl">0.4</span>,</span>
<span id="cb177-27"><a href="#cb177-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb177-28"><a href="#cb177-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(),<span class="at">file =</span> <span class="st">"m2.html"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe valign="center" src="m2.html" width="640" height="800" frameborder="0">
</iframe>
<figcaption>
<em>Magnitude Change Map </em>
</figcaption>
<p>
<iframe valign="center" src="m1.html" width="640" height="800" frameborder="0">
</iframe>
</p><figcaption>
<em>Period of Change Map </em>
</figcaption>
</section>
</section>
<section id="step-3---generating-training-data" class="level2">
<h2 class="anchored" data-anchor-id="step-3---generating-training-data">Step 3 - Generating training data</h2>
<p>For a supervised classification, we need data that indicates which surface class defined areas of the satellite image belong to. This data is referred to as training data and is very often obtained by manual digitization. This can be done quite comfortably in RStudio if only a few training areas have to be digitized quickly and effectively.</p>
<p>We assume that we want to classify two types of land cover: <em>clearcut</em> and <em>other</em>.</p>
<p>For larger tasks, it makes sense to use the convenient method described in the current QGIS documentation, for example in the <a href="https://docs.qgis.org/3.34/en/docs/training_manual/create_vector_data/create_new_vector.html#basic-ty-digitizing-polygons">digitizing tutorial</a>.</p>
<p><a href="../reader/digitize.html" class="btn btn-outline-primary" role="button" data-toggle="tooltip" title="Digitizing training data using mapedit">Digitizing training data in R</a></p>
<p>Assuming we have digitized trainingdata using either QGIS or R We need now to extract the values according to the assigned areas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>pred_stack_2018 <span class="ot">=</span> <span class="fu">rast</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/pred_stack_2018.tif"</span>))</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>pred_stack_2022 <span class="ot">=</span> <span class="fu">rast</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/pred_stack_2022.tif"</span>))</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="co"># use the provided training data set</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the training data for the digitized areas</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>tDF_2019 <span class="ot">=</span> exactextractr<span class="sc">::</span><span class="fu">exact_extract</span>(pred_stack_2018, <span class="fu">filter</span>(train_areas_2019_2020,year<span class="sc">==</span><span class="dv">2019</span>), <span class="at">force_df =</span> <span class="cn">TRUE</span>,</span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="at">include_cell =</span> <span class="cn">TRUE</span>,<span class="at">include_xy =</span> <span class="cn">TRUE</span>,<span class="at">full_colnames =</span> <span class="cn">TRUE</span>,<span class="at">include_cols =</span> <span class="st">"class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |============================================                          |  62%
  |                                                                            
  |=============================================                         |  65%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>tDF_2020 <span class="ot">=</span> exactextractr<span class="sc">::</span><span class="fu">exact_extract</span>(pred_stack_2022, <span class="fu">filter</span>(train_areas_2019_2020,year<span class="sc">==</span><span class="dv">2020</span>), <span class="at">force_df =</span> <span class="cn">TRUE</span>,</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="at">include_cell =</span> <span class="cn">TRUE</span>,<span class="at">include_xy =</span> <span class="cn">TRUE</span>,<span class="at">full_colnames =</span> <span class="cn">TRUE</span>,<span class="at">include_cols =</span> <span class="st">"class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |==============                                                        |  21%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |========================================================              |  79%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># again, copy together into a file</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>tDF_2019 <span class="ot">=</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(tDF_2019)</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>tDF_2019<span class="sc">$</span>year <span class="ot">=</span> <span class="dv">2019</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>tDF_2020 <span class="ot">=</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(tDF_2020)</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>tDF_2020<span class="sc">$</span>year <span class="ot">=</span> <span class="dv">2020</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete any rows that contain NA (no data) values</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>tDF_2019 <span class="ot">=</span> tDF_2019[<span class="fu">complete.cases</span>(tDF_2019) ,]</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>tDF_2020 <span class="ot">=</span> tDF_2020[<span class="fu">complete.cases</span>(tDF_2020) ,]</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>tDF<span class="ot">=</span> <span class="fu">rbind</span>(tDF_2019,tDF_2020)</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a><span class="co"># check the extracted data</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tDF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    class                B01              B02              B03      
 Length:69883       Min.   :  86.0   Min.   :  45.0   Min.   :  66  
 Class :character   1st Qu.: 177.0   1st Qu.: 170.0   1st Qu.: 338  
 Mode  :character   Median : 216.0   Median : 230.0   Median : 466  
                    Mean   : 333.4   Mean   : 378.6   Mean   : 598  
                    3rd Qu.: 459.0   3rd Qu.: 530.0   3rd Qu.: 814  
                    Max.   :2168.0   Max.   :5620.0   Max.   :7272  
      B04              B05              B06            B07            B08      
 Min.   :  20.0   Min.   :  15.0   Min.   :   0   Min.   :   0   Min.   :   0  
 1st Qu.: 190.0   1st Qu.: 642.0   1st Qu.:1751   1st Qu.:1981   1st Qu.:2042  
 Median : 278.0   Median : 854.0   Median :2498   Median :2929   Median :3168  
 Mean   : 555.7   Mean   : 994.3   Mean   :2357   Mean   :2902   Mean   :3085  
 3rd Qu.: 850.0   3rd Qu.:1332.0   3rd Qu.:3107   3rd Qu.:3946   3rd Qu.:4164  
 Max.   :9344.0   Max.   :5904.0   Max.   :5991   Max.   :6260   Max.   :7032  
      B8A            B09            B11            B12            EVI        
 Min.   :   0   Min.   :   0   Min.   :  19   Min.   :  17   Min.   :  0.00  
 1st Qu.:2144   1st Qu.:2219   1st Qu.:1497   1st Qu.: 706   1st Qu.: 12.00  
 Median :3274   Median :3314   Median :1923   Median : 908   Median : 73.00  
 Mean   :3168   Mean   :3214   Mean   :1784   Mean   :1019   Mean   : 84.35  
 3rd Qu.:4286   3rd Qu.:4349   3rd Qu.:2199   3rd Qu.:1395   3rd Qu.:121.00  
 Max.   :6582   Max.   :6119   Max.   :5012   Max.   :4536   Max.   :255.00  
     kNDVI             SAVI              x               y        
 Min.   :  0.00   Min.   :  6.00   Min.   :10.21   Min.   :51.85  
 1st Qu.:  0.00   1st Qu.: 14.00   1st Qu.:10.25   1st Qu.:51.90  
 Median : 27.00   Median : 73.00   Median :10.32   Median :51.93  
 Mean   : 64.77   Mean   : 84.91   Mean   :10.30   Mean   :51.92  
 3rd Qu.:119.00   3rd Qu.:118.00   3rd Qu.:10.36   3rd Qu.:51.94  
 Max.   :255.00   Max.   :255.00   Max.   :10.40   Max.   :51.94  
      cell         coverage_fraction      year     
 Min.   : 158288   Min.   :0.0000    Min.   :2019  
 1st Qu.: 274404   1st Qu.:1.0000    1st Qu.:2019  
 Median : 449043   Median :1.0000    Median :2019  
 Mean   : 596758   Mean   :0.9199    Mean   :2019  
 3rd Qu.: 813870   3rd Qu.:1.0000    3rd Qu.:2020  
 Max.   :1655492   Max.   :1.0000    Max.   :2020  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save as R internal data format</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="co"># is stored in the repo and can therefore be loaded (line below)</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(tDF, <span class="fu">paste0</span>(<span class="st">"../data/tDF_2018_2022.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-4---supervised-classification" class="level2">
<h2 class="anchored" data-anchor-id="step-4---supervised-classification">Step 4 - supervised classification</h2>
<p>Classifiers (e.g.&nbsp;the maximum likelihood classifier) or machine learning algorithms (such as Random Forest) use the training data to determine descriptive models that represent statistical signatures, classification trees or other functions. Within the limits of the quality of the training data, such models are suitable and representative for making predictions for areas if the predictors from the model are available for the entire area.</p>
<p>We now want to predict the spatial characteristics of clear-felling/no forest using a maximum likelihood classification and random forest, and apply standard methods of random validation and model quality assessment.</p>
<p>The goal is to separate clearcuts from all other pixels and to quantify the differences between 2019 and 2020.</p>
<section id="maximum-likelihood-classification-1" class="level3">
<h3 class="anchored" data-anchor-id="maximum-likelihood-classification-1">Maximum Likelihood Classification</h3>
<p>Since the maximum likelihood algorithm requires training data, it is a supervised learning method. This means that we, as users, have to provide the algorithm with data that conveys knowledge about the classes to be predicted. This data is then divided into training and test data.</p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Maximum Likelihood Classification ----</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Here the caret utility package is used</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting a "seed" enables reproducible randomness</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>tDF <span class="ot">=</span> <span class="fu">readRDS</span>( <span class="fu">file.path</span>(root_folder,<span class="st">"data/tDF_2018_2022.rds"</span>))</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly draw 15% of the data (training/test)</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">=</span> <span class="fu">createDataPartition</span>(tDF<span class="sc">$</span>class,<span class="at">list =</span> <span class="cn">FALSE</span>,<span class="at">p =</span> <span class="fl">0.05</span>)</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>trainDat <span class="ot">=</span> tDF[idx,]</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>testDat <span class="ot">=</span> tDF[<span class="sc">-</span>idx,]</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Response variable (= "class" column) must be of the "factor" data type</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>trainDat<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(trainDat<span class="sc">$</span>class)</span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>testDat<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testDat<span class="sc">$</span>class)</span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a><span class="co"># superClass() function from the RSToolbox package requires the table to be converted into the</span></span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a><span class="co"># required (old) SpatialdataPoint object</span></span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a>sp_trainDat <span class="ot">=</span> trainDat</span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a>sp_testDat <span class="ot">=</span> testDat </span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a>sp<span class="sc">::</span><span class="fu">coordinates</span>(sp_trainDat) <span class="ot">=</span> <span class="er">~</span>x<span class="sc">+</span>y</span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a>sp<span class="sc">::</span><span class="fu">coordinates</span>(sp_testDat) <span class="ot">=</span> <span class="er">~</span>x<span class="sc">+</span>y</span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(sp_trainDat) <span class="ot">=</span> <span class="fu">crs</span>(pred_stack_2018)</span>
<span id="cb185-26"><a href="#cb185-26" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(sp_testDat) <span class="ot">=</span> <span class="fu">crs</span>(pred_stack_2018)</span>
<span id="cb185-27"><a href="#cb185-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-28"><a href="#cb185-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-29"><a href="#cb185-29" aria-hidden="true" tabindex="-1"></a><span class="co"># superClass method "mlc" trains the model and then classifies it</span></span>
<span id="cb185-30"><a href="#cb185-30" aria-hidden="true" tabindex="-1"></a>prediction_mlc_2018 <span class="ot">&lt;-</span> <span class="fu">superClass</span>(pred_stack_2018, <span class="at">trainData =</span> sp_trainDat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>],<span class="at">valData =</span> sp_testDat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>], <span class="at">responseCol =</span> <span class="st">"class"</span>, <span class="at">model =</span> <span class="st">"mlc"</span>, <span class="at">tuneLength =</span> <span class="dv">1</span>, <span class="at">trainPartition =</span> <span class="fl">0.3</span>,<span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">filename=</span><span class="fu">file.path</span>(root_folder,<span class="st">"data/prediction_mlc_2018.tif"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_buffer.sfc(st_geometry(x), dist, nQuadSegs, endCapStyle =
endCapStyle, : st_buffer does not correctly buffer longitude/latitude data
Warning in st_buffer.sfc(st_geometry(x), dist, nQuadSegs, endCapStyle =
endCapStyle, : st_buffer does not correctly buffer longitude/latitude data
Warning in st_buffer.sfc(st_geometry(x), dist, nQuadSegs, endCapStyle =
endCapStyle, : st_buffer does not correctly buffer longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum Likelihood Classification 

3490 samples
  15 predictor
   2 classes: 'clearcut', 'other' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 2793, 2792, 2792, 2791, 2792 
Resampling results:

  Accuracy   Kappa    
  0.8999987  0.3932103

[[1]]
  TrainAccuracy TrainKappa method
1     0.8999987  0.3932103 custom

[[2]]
Cross-Validated (5 fold) Confusion Matrix 

(entries are average cell counts across resamples)
 
          Reference
Prediction clearcut other
  clearcut     26.2  68.6
  other         1.2 602.0
                         
 Accuracy (average) : 0.9


Confusion Matrix and Statistics

          Reference
Prediction clearcut other
  clearcut     1265  2538
  other          63 23130
                                          
               Accuracy : 0.9037          
                 95% CI : (0.9001, 0.9071)
    No Information Rate : 0.9508          
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.4532          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.95256         
            Specificity : 0.90112         
         Pos Pred Value : 0.33263         
         Neg Pred Value : 0.99728         
             Prevalence : 0.04919         
         Detection Rate : 0.04686         
   Detection Prevalence : 0.14087         
      Balanced Accuracy : 0.92684         
                                          
       'Positive' Class : clearcut        
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>prediction_mlc_2022 <span class="ot">&lt;-</span> <span class="fu">superClass</span>(pred_stack_2022, <span class="at">trainData =</span> sp_trainDat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>],<span class="at">valData =</span> sp_testDat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>], <span class="at">responseCol =</span> <span class="st">"class"</span>,<span class="at">model =</span> <span class="st">"mlc"</span>, <span class="at">tuneLength =</span> <span class="dv">1</span>, <span class="at">trainPartition =</span> <span class="fl">0.3</span>,<span class="at">verbose =</span> <span class="cn">TRUE</span>,<span class="at">filename=</span><span class="fu">file.path</span>(root_folder,<span class="st">"data/prediction_mlc_2022.tif"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_buffer.sfc(st_geometry(x), dist, nQuadSegs, endCapStyle =
endCapStyle, : st_buffer does not correctly buffer longitude/latitude data
Warning in st_buffer.sfc(st_geometry(x), dist, nQuadSegs, endCapStyle =
endCapStyle, : st_buffer does not correctly buffer longitude/latitude data
Warning in st_buffer.sfc(st_geometry(x), dist, nQuadSegs, endCapStyle =
endCapStyle, : st_buffer does not correctly buffer longitude/latitude data</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum Likelihood Classification 

3490 samples
  15 predictor
   2 classes: 'clearcut', 'other' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 2791, 2792, 2792, 2793, 2792 
Resampling results:

  Accuracy   Kappa    
  0.9469852  0.5640534

[[1]]
  TrainAccuracy TrainKappa method
1     0.9469852  0.5640534 custom

[[2]]
Cross-Validated (5 fold) Confusion Matrix 

(entries are average cell counts across resamples)
 
          Reference
Prediction clearcut other
  clearcut     26.2  35.8
  other         1.2 634.8
                           
 Accuracy (average) : 0.947


Confusion Matrix and Statistics

          Reference
Prediction clearcut other
  clearcut     1289  1789
  other          39 23879
                                          
               Accuracy : 0.9323          
                 95% CI : (0.9292, 0.9353)
    No Information Rate : 0.9508          
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.5545          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.97063         
            Specificity : 0.93030         
         Pos Pred Value : 0.41878         
         Neg Pred Value : 0.99837         
             Prevalence : 0.04919         
         Detection Rate : 0.04775         
   Detection Prevalence : 0.11402         
      Balanced Accuracy : 0.95047         
                                          
       'Positive' Class : clearcut        
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(prediction_mlc_2018, <span class="fu">file.path</span>(root_folder,<span class="st">"data/prediction_mlc_2018.rds"</span>))</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(prediction_mlc_2022, <span class="fu">file.path</span>(root_folder,<span class="st">"data/prediction_mlc_2022.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="random-forest-1" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-1">Random forest</h3>
<p>A simplified version of the workflow proposed by Max Kuhn <span class="citation" data-cites="caret">(<a href="#ref-caret" role="doc-biblioref">Kuhn and Max 2008</a>)</span> and improved by Hanna Meyer et al. <span class="citation" data-cites="cast">(<a href="#ref-cast" role="doc-biblioref">Meyer et al. 2024</a>)</span> is used for the random forest classification. For further understanding visit The <a href="https://hannameyer.github.io/CAST/">CAST documentation</a></p>
</section>
<section id="prediction-on-the-original-data" class="level3">
<h3 class="anchored" data-anchor-id="prediction-on-the-original-data">Prediction on the original data</h3>
<p>Now we are ready to apply the verified model to our data set. In remote sensing, this is usually called classification.</p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/rf_model.rds"</span>))</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification (also known as prediction)</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>prediction_rf_2018  <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">predict</span>(pred_stack_2018 ,rf_model)</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>prediction_rf_2022  <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">predict</span>(pred_stack_2022 ,rf_model)</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(prediction_rf_2018, <span class="fu">file.path</span>(root_folder,<span class="st">"data/prediction_rf_2018.rds"</span>))</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(prediction_rf_2022, <span class="fu">file.path</span>(root_folder,<span class="st">"data/prediction_rf_2022.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ##</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>prediction_rf_2018 <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/prediction_rf_2018.rds"</span>))</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>prediction_rf_2022 <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/prediction_rf_2022.rds"</span>))</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>prediction_mlc_2018 <span class="ot">=</span> <span class="fu">rast</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/prediction_mlc_2018.tif"</span>))</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>prediction_mlc_2022 <span class="ot">=</span> <span class="fu">rast</span>(<span class="fu">file.path</span>(root_folder,<span class="st">"data/prediction_mlc_2022.tif"</span>))</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Visualisierung mit mapview ----</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>mask <span class="ot">=</span> <span class="fu">resample</span>(harz_forest_mask,pred_stack_2022)</span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mask<span class="sc">*</span>prediction_rf_2022 <span class="sc">-</span> mask<span class="sc">*</span>prediction_rf_2018) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/comparison_classifications-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mask<span class="sc">*</span>prediction_mlc_2022<span class="sc">-</span>mask<span class="sc">*</span>prediction_mlc_2018)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cd-1_files/figure-html/comparison_classifications-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<iframe valign="center" src="compare-class1.html" width="640" height="960" frameborder="0" allowfullscreen="allowfullscreen">
</iframe>
<p>A visual comparison shows that the Random Forest and Maximum Likelihood classifications provide results of comparable quality. But does this impression stand up to quantitative analysis?</p>
</section>
<section id="step-5-estimation-model-quality" class="level3">
<h3 class="anchored" data-anchor-id="step-5-estimation-model-quality">Step 5: Estimation model quality</h3>
<p>The test data are now used for the independent quality check of the model. A confusion matrix indicates how accurately the model predicts the correct classes. The main diagonal of the matrix indicates the cases in which the model applies. In our classification of only two classes, however, a special case applies: <a href="https://en.wikipedia.org/wiki/Evaluation_of_binary_classifiers">evaluation of a binary classifier</a>. Detailed explanations for the function used here can be found in the <a href="https://topepo.github.io/caret/measuring-performance.html#measures-for-predicted-classes">caret help</a>.</p>
<p>The main statements about model quality are:</p>
<ul>
<li><em>‘Positive’ Class</em> = <strong>clearcut</strong>: is measured with the sensitivity (<em>true positive rate</em>), which indicates the probability that a positive object is correctly classified as positive.</li>
<li><em>‘Negative Class’</em> = <strong>other</strong>: is measured with the specificity (<em>true negative rate</em>) and indicates the probability that a negative object is correctly classified as negative.</li>
<li><em>Positive and negative predictive values</em> indicate the actual performance for <em>clearcut</em> and <em>other</em>. They are corrected for the actual frequency distribution and are a measure of the precision and performance of the model with regard to the respective classes.</li>
</ul>
<p>Despite the high values, we see that the <em>clearcut</em> class drops off significantly here. This can certainly be taken as an indication of the need to improve the classification.</p>
<p>Overall, however, the model can be considered good.</p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: false</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ##</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----Calculation of the confusion matrix  ----</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>cm_rf <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(<span class="at">data =</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> testDat), testDat<span class="sc">$</span>class)</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>cm_rf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction clearcut other
  clearcut     1414   246
  other        1186 63542
                                          
               Accuracy : 0.9784          
                 95% CI : (0.9773, 0.9795)
    No Information Rate : 0.9608          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6533          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.54385         
            Specificity : 0.99614         
         Pos Pred Value : 0.85181         
         Neg Pred Value : 0.98168         
             Prevalence : 0.03916         
         Detection Rate : 0.02130         
   Detection Prevalence : 0.02500         
      Balanced Accuracy : 0.76999         
                                          
       'Positive' Class : clearcut        
                                          </code></pre>
</div>
</div>
</section>
</section>
<section id="further-support" class="level2">
<h2 class="anchored" data-anchor-id="further-support">Further support</h2>
<p>Consider the following resources as examples of how a specific conceptual and technical approach to answering a question can be <em>“crystallized”</em> step by step from the wide range of instructions available on the internet. After a lot of research and critical cross-checking, a <em>“state of research”</em> that is currently considered to be certain within the scientific community can be identified, which can be regarded as a sufficient basis for good scientific practice.</p>
<p>Work/read through the following selection of blogs and guides, even for practice purposes.</p>
<ul>
<li><a href="http://www.charim.net/sites/default/files/handbook/datamanagement/3/3.3/The%20core%20of%20GIScience%2C%20a%20system%20-based%20approach.pdf">The core of GIScience</a> <a href="ftp://ftp.itc.nl/pub/ders/CoreBook2014_metadata.pdf">Download</a> The editors Tolpekin &amp; Stein 2012 are providing an excellent insight into GI concepts.</li>
<li>Robert J. Hijmans <a href="https://rspatial.org/raster/rs/5-supclassification.html">rspatial - supervised classification</a></li>
<li>Ivan Lizarazo <a href="https://rpubs.com/ials2un/rf_landcover">RPubs Tutorial</a></li>
<li>Sydney Goldstein <a href="https://urbanspatial.github.io/classifying_satellite_imagery_in_R/">blog</a></li>
<li>João Gonçalves <a href="https://www.r-exercises.com/2018/03/07/advanced-techniques-with-raster-data-part-2-supervised-classification/">supervised classification</a></li>
<li>Valentin Stefan <a href="https://valentinitnelav.github.io/satellite-image-classification-r/">pixel-based supervised classification</a></li>
</ul>
<p>In the articles, you will always find both technical instructions and conceptual or specific technical questions and solutions. They are by no means a substitute for specialized scientific knowledge. But they show how technical and conceptual understanding can be developed step by step and, by “replicating” and applying, support the skills needed to approach questions independently.</p>
<p>I would like to explicitly quote Valentin Stefan, the author of the blog post <a href="https://valentinitnelav.github.io/satellite-image-classification-r/">pixel-based supervised classification</a>:</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><em>“[…] Consider this content a blog post and nothing more. It does not claim to be an exhaustive exercise or a substitute for your critical thinking […].”</em> :::</p>
</div>
</div>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-gdalcubes" class="csl-entry" role="listitem">
Appel, Marius, and Edzer Pebesma. 2019. <span>“On-Demand Processing of Data Cubes from Satellite Image Collections with the Gdalcubes Library.”</span> <em>Data</em> 4 (3). <a href="https://www.mdpi.com/2306-5729/4/3/92">https://www.mdpi.com/2306-5729/4/3/92</a>.
</div>
<div id="ref-rstac" class="csl-entry" role="listitem">
Brazil Data Cube Team. 2021. <em>Rstac: Client Library for SpatioTemporal Asset Catalog</em>. <a href="https://github.com/brazil-data-cube/rstac">https://github.com/brazil-data-cube/rstac</a>.
</div>
<div id="ref-caret" class="csl-entry" role="listitem">
Kuhn, and Max. 2008. <span>“Building Predictive Models in r Using the Caret Package.”</span> <em>Journal of Statistical Software</em> 28 (5): 1–26. <a href="https://doi.org/10.18637/jss.v028.i05">https://doi.org/10.18637/jss.v028.i05</a>.
</div>
<div id="ref-openeo" class="csl-entry" role="listitem">
Lahn, Florian. 2024. <em>Openeo: Client Interface for ’openEO’ Servers</em>. <a href="https://CRAN.R-project.org/package=openeo">https://CRAN.R-project.org/package=openeo</a>.
</div>
<div id="ref-cast" class="csl-entry" role="listitem">
Meyer, Hanna, Carles Milà, Marvin Ludwig, Jan Linnenbrink, and Fabian Schumacher. 2024. <em>CAST: ’Caret’ Applications for Spatial-Temporal Models</em>. <a href="https://github.com/HannaMeyer/CAST">https://github.com/HannaMeyer/CAST</a>.
</div>
<div id="ref-stars" class="csl-entry" role="listitem">
Pebesma, Edzer. 2019. <em>Stars: Spatiotemporal Arrays, Raster and Vector Data Cubes</em>. <a href="https://CRAN.R-project.org/package=stars">https://CRAN.R-project.org/package=stars</a>.
</div>
<div id="ref-tmap" class="csl-entry" role="listitem">
Tennekes, Martijn. 2018. <span>“<span class="nocase">tmap</span>: Thematic Maps in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 84 (6): 1–39. <a href="https://doi.org/10.18637/jss.v084.i06">https://doi.org/10.18637/jss.v084.i06</a>.
</div>
<div id="ref-bfast" class="csl-entry" role="listitem">
Verbesselt, Jan, Achim Zeileis, and Martin Herold. 2012. <span>“Near Real-Time Disturbance Detection Using Satellite Image Time Series.”</span> <em>Remote Sensing of Environment</em> 123: 98–108. <a href="https://doi.org/10.1016/j.rse.2012.02.022">https://doi.org/10.1016/j.rse.2012.02.022</a>.
</div>
<div id="ref-bfast_rs2020" class="csl-entry" role="listitem">
Wu, Ling, Zhaoliang Li, Xiangnan Liu, Lihong Zhu, Yibo Tang, Biyao Zhang, Boliang Xu, Meiling Liu, Yuanyuan Meng, and Boyuan Liu. 2020. <span>“Multi-Type Forest Change Detection Using BFAST and Monthly Landsat Time Series for Monitoring Spatiotemporal Dynamics of Forests in Subtropical Wetland.”</span> <em>Remote Sensing</em> 12 (2). <a href="https://doi.org/10.3390/rs12020341">https://doi.org/10.3390/rs12020341</a>.
</div>
<div id="ref-colorspace" class="csl-entry" role="listitem">
Zeileis, Achim, Jason C. Fisher, Kurt Hornik, Ross Ihaka, Claire D. McWhite, Paul Murrell, Reto Stauffer, and Claus O. Wilke. 2020. <span>“<span class="nocase">colorspace</span>: A Toolbox for Manipulating and Assessing Colors and Palettes.”</span> <em>Journal of Statistical Software</em> 96 (1): 1–49. <a href="https://doi.org/10.18637/jss.v096.i01">https://doi.org/10.18637/jss.v096.i01</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/www\.quarto\.org\/custom");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="gisma-courses/LV-19-d19-006-24" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>LV-19-d19-006-24 (2024)</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gisma-courses/LV-19-d19-006-24/edit/main/reader/cd-1.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gisma-courses/LV-19-d19-006-24/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>